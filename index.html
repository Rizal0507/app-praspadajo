<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aplikasi Absensi dan Tugas - PASKIBRA SMPN 2 Jogoroto</title>
    <meta name="description" content="Sistem manajemen absensi dan tugas untuk ekstrakurikuler Paskibra SMP Negeri 2 Jogoroto">
    <meta name="keywords" content="paskibra, absensi, tugas, smpn 2 jogoroto, ekstrakurikuler">
    <meta name="author" content="PASKIBRA SMPN 2 Jogoroto">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; }
        .gradient-bg { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
        .card-shadow { box-shadow: 0 10px 25px rgba(0,0,0,0.1); }
        .btn-primary { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
        .btn-primary:hover { background: linear-gradient(135deg, #5a6fd8 0%, #6a4190 100%); }
        .hidden { display: none; }
        .qr-scanner { 
            width: 300px; 
            height: 300px; 
            border: 3px dashed #667eea; 
            background: #f8fafc;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto;
        }
        
        /* Production optimizations */
        * {
            -webkit-tap-highlight-color: transparent;
        }
        
        .btn-primary, button {
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }
        
        /* Loading animation */
        .loading {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: .5; }
        }
        
        /* Shake animation for error messages */
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
            20%, 40%, 60%, 80% { transform: translateX(5px); }
        }
        
        /* Responsive improvements */
        @media (max-width: 640px) {
            .card-shadow {
                box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            }
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Landing Page -->
    <div id="landingPage" class="min-h-screen relative overflow-hidden">
        <!-- Background with animated elements -->
        <div class="absolute inset-0 gradient-bg">
            <div class="absolute top-10 left-10 w-20 h-20 bg-white bg-opacity-10 rounded-full animate-pulse"></div>
            <div class="absolute top-32 right-20 w-16 h-16 bg-white bg-opacity-10 rounded-full animate-pulse delay-1000"></div>
            <div class="absolute bottom-20 left-20 w-24 h-24 bg-white bg-opacity-10 rounded-full animate-pulse delay-2000"></div>
            <div class="absolute bottom-32 right-10 w-12 h-12 bg-white bg-opacity-10 rounded-full animate-pulse delay-500"></div>
        </div>
        
        <div class="relative z-10 min-h-screen flex items-center justify-center p-4">
            <div class="bg-white rounded-3xl card-shadow p-8 w-full max-w-md backdrop-blur-sm bg-opacity-95">
                <!-- Logo and Title -->
                <div class="text-center mb-8">
                    <!-- Enhanced Logo -->
                    <div class="relative mb-6">
                        <div class="w-24 h-24 bg-gradient-to-br from-red-500 to-red-700 rounded-full flex items-center justify-center mx-auto shadow-lg">
                            <i class="fas fa-flag text-white text-3xl"></i>
                        </div>
                        <div class="absolute -bottom-2 -right-2 w-8 h-8 bg-yellow-400 rounded-full flex items-center justify-center shadow-md">
                            <i class="fas fa-star text-yellow-800 text-sm"></i>
                        </div>
                    </div>
                    
                    <h1 class="text-3xl font-bold bg-gradient-to-r from-gray-800 to-gray-600 bg-clip-text text-transparent mb-2">
                        PASKIBRA
                    </h1>
                    <h2 class="text-lg font-semibold text-gray-700 mb-1">Sistem Absensi & Tugas</h2>
                    <p class="text-gray-600 text-sm">SMP Negeri 2 Jogoroto</p>
                    
                    <!-- Connection Status -->
                    <div class="mt-4 inline-flex items-center px-3 py-1 bg-green-50 border border-green-200 rounded-full">
                        <div class="w-2 h-2 bg-green-500 rounded-full mr-2 animate-pulse"></div>
                        <span class="text-xs text-green-700 font-medium">Online & Tersinkronisasi</span>
                    </div>
                    <p class="text-xs text-gray-500 mt-1">
                        <i class="fas fa-cloud mr-1"></i>
                        Google Drive: tjakrabirawa03@gmail.com
                    </p>
                </div>

                <!-- Enhanced Digital Clock -->
                <div class="text-center mb-8">
                    <div class="bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl p-4 border border-blue-100">
                        <div id="digitalClock" class="text-3xl font-mono font-bold text-blue-700 mb-1"></div>
                        <div id="currentDate" class="text-sm text-blue-600 font-medium"></div>
                    </div>
                </div>

                <!-- Enhanced Login Form -->
                <form id="loginForm" class="space-y-5">
                    <!-- Error Message -->
                    <div id="loginError" class="hidden bg-red-50 border border-red-200 rounded-xl p-4 mb-4">
                        <div class="flex items-center">
                            <i class="fas fa-exclamation-triangle text-red-500 mr-3"></i>
                            <div>
                                <h4 class="text-red-800 font-medium">Login Gagal!</h4>
                                <p class="text-red-700 text-sm mt-1">Password salah! Silakan periksa kembali username dan password Anda.</p>
                            </div>
                        </div>
                    </div>

                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">
                            <i class="fas fa-user-tag mr-2 text-blue-600"></i>Masuk Sebagai
                        </label>
                        <select id="userRole" class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-gray-50 hover:bg-white">
                            <option value="siswa">üë®‚Äçüéì Siswa</option>
                            <option value="pelatih">üë®‚Äçüè´ Pelatih</option>
                            <option value="admin">üë®‚Äçüíº Admin</option>
                        </select>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">
                            <i class="fas fa-user mr-2 text-blue-600"></i>Username
                        </label>
                        <input type="text" id="username" class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-gray-50 hover:bg-white" placeholder="Masukkan username Anda">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">
                            <i class="fas fa-lock mr-2 text-blue-600"></i>Password
                        </label>
                        <div class="relative">
                            <input type="password" id="password" class="w-full px-4 py-3 pr-12 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-gray-50 hover:bg-white" placeholder="Masukkan password Anda">
                            <button type="button" onclick="togglePasswordVisibility('password')" class="absolute inset-y-0 right-0 pr-4 flex items-center">
                                <i id="password-icon" class="fas fa-eye text-gray-400 hover:text-blue-600 transition-colors duration-200"></i>
                            </button>
                        </div>
                    </div>
                    
                    <button type="submit" class="w-full btn-primary text-white py-3 rounded-xl font-semibold hover:shadow-xl transition-all duration-300 transform hover:scale-105">
                        <i class="fas fa-sign-in-alt mr-2"></i>Masuk ke Sistem
                    </button>
                </form>
                

                
                <!-- Footer -->
                <div class="mt-6 text-center">
                    <p class="text-xs text-gray-500">
                        ¬© 2024 PASKIBRA SMPN 2 Jogoroto
                    </p>
                    <div class="flex justify-center items-center mt-2 space-x-4 text-xs text-gray-400">
                        <span><i class="fas fa-shield-alt mr-1"></i>Aman</span>
                        <span><i class="fas fa-mobile-alt mr-1"></i>Responsif</span>
                        <span><i class="fas fa-sync-alt mr-1"></i>Real-time</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Admin Dashboard -->
    <div id="adminDashboard" class="hidden min-h-screen bg-gray-50">
        <!-- Header -->
        <header class="bg-white shadow-sm border-b">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex justify-between items-center py-4">
                    <div class="flex items-center">
                        <div class="w-10 h-10 bg-red-600 rounded-full flex items-center justify-center mr-3">
                            <i class="fas fa-flag text-white"></i>
                        </div>
                        <h1 class="text-xl font-semibold text-gray-800">Admin Dashboard</h1>
                    </div>
                    <div class="flex items-center space-x-4">
                        <button onclick="logout()" class="text-red-600 hover:text-red-800">
                            <i class="fas fa-sign-out-alt mr-2"></i>Keluar
                        </button>
                    </div>
                </div>
            </div>
        </header>

        <!-- Navigation -->
        <nav class="bg-white shadow-sm">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex space-x-8">
                    <button onclick="showAdminSection('absensiManual')" class="admin-nav-btn py-4 px-2 border-b-2 border-blue-500 text-blue-600">
                        <i class="fas fa-clipboard-check mr-2"></i>Absensi Manual
                    </button>
                    <button onclick="showAdminSection('absensiQR')" class="admin-nav-btn py-4 px-2 border-b-2 border-transparent hover:border-blue-500 text-gray-600 hover:text-blue-600">
                        <i class="fas fa-qrcode mr-2"></i>Scan QR Code
                    </button>
                    <button onclick="showAdminSection('jurnalKegiatan')" class="admin-nav-btn py-4 px-2 border-b-2 border-transparent hover:border-blue-500 text-gray-600 hover:text-blue-600">
                        <i class="fas fa-journal-whills mr-2"></i>Jurnal Kegiatan
                    </button>
                </div>
            </div>
        </nav>

        <!-- Admin Content -->
        <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
            <!-- Absensi Manual Section -->
            <div id="absensiManual" class="admin-section">
                <h2 class="text-2xl font-bold text-gray-800 mb-6">Absensi Manual</h2>
                
                <!-- Real-time Clock -->
                <div class="bg-white rounded-lg card-shadow p-6 mb-6">
                    <div class="text-center">
                        <div id="adminCurrentTime" class="text-4xl font-mono text-blue-600 mb-2"></div>
                        <div id="adminCurrentDate" class="text-lg text-gray-600"></div>
                    </div>
                </div>
                
                <!-- Class Sections -->
                <div class="space-y-6">
                    <!-- Kelas 7 -->
                    <div class="bg-white rounded-lg card-shadow p-6">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4 flex items-center">
                            <span class="bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm mr-3">Kelas 7</span>
                            Absensi Kelas 7
                        </h3>
                        <div id="class7AttendanceList" class="space-y-4">
                            <!-- Class 7 attendance list will be populated here -->
                        </div>
                    </div>
                    
                    <!-- Kelas 8 -->
                    <div class="bg-white rounded-lg card-shadow p-6">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4 flex items-center">
                            <span class="bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm mr-3">Kelas 8</span>
                            Absensi Kelas 8
                        </h3>
                        <div id="class8AttendanceList" class="space-y-4">
                            <!-- Class 8 attendance list will be populated here -->
                        </div>
                    </div>
                    
                    <!-- Kelas 9 -->
                    <div class="bg-white rounded-lg card-shadow p-6">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4 flex items-center">
                            <span class="bg-purple-100 text-purple-800 px-3 py-1 rounded-full text-sm mr-3">Kelas 9</span>
                            Absensi Kelas 9
                        </h3>
                        <div id="class9AttendanceList" class="space-y-4">
                            <!-- Class 9 attendance list will be populated here -->
                        </div>
                    </div>
                </div>
                
                <!-- Attendance Summary -->
                <div id="attendanceSummary" class="hidden bg-white rounded-lg card-shadow p-6 mt-6">
                    <h3 class="text-lg font-semibold text-gray-800 mb-4">Ringkasan Absensi Tersimpan</h3>
                    <div id="attendanceSummaryContent">
                        <!-- Summary content will be populated here -->
                    </div>
                </div>
                
                <button onclick="saveAttendance()" class="mt-6 btn-primary text-white px-6 py-2 rounded-lg hover:shadow-lg transition-all">
                    <i class="fas fa-save mr-2"></i>Simpan Absensi
                </button>
            </div>

            <!-- Absensi QR Section -->
            <div id="absensiQR" class="admin-section hidden">
                <h2 class="text-2xl font-bold text-gray-800 mb-6">Absensi dengan Scan QR Code</h2>
                <div class="bg-white rounded-lg card-shadow p-6 text-center">
                    <div class="qr-scanner mb-6">
                        <div class="text-center">
                            <i class="fas fa-qrcode text-6xl text-gray-400 mb-4"></i>
                            <p class="text-gray-600">Arahkan kamera ke QR Code siswa</p>
                        </div>
                    </div>
                    <button onclick="startQRScan()" class="btn-primary text-white px-6 py-2 rounded-lg hover:shadow-lg transition-all">
                        <i class="fas fa-camera mr-2"></i>Mulai Scan
                    </button>
                    
                    <!-- QR Scan Result -->
                    <div id="qrScanResult" class="hidden mt-6 p-4 bg-gray-50 rounded-lg">
                        <h3 class="font-semibold text-gray-800 mb-4">Data Siswa Terdeteksi:</h3>
                        <div id="scannedStudentInfo" class="text-left">
                            <!-- Scanned student info will appear here -->
                        </div>
                        <div class="mt-4 flex justify-center space-x-4">
                            <button onclick="markAttendance('hadir')" class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700">Hadir</button>
                            <button onclick="markAttendance('izin')" class="bg-yellow-600 text-white px-4 py-2 rounded-lg hover:bg-yellow-700">Izin</button>
                            <button onclick="markAttendance('sakit')" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700">Sakit</button>
                            <button onclick="markAttendance('alpha')" class="bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700">Alpha</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Jurnal Kegiatan Section for Admin -->
            <div id="jurnalKegiatan" class="admin-section hidden">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold text-gray-800">Jurnal Kegiatan</h2>
                    <button onclick="showModal('addJournalModal')" class="btn-primary text-white px-4 py-2 rounded-lg hover:shadow-lg transition-all">
                        <i class="fas fa-plus mr-2"></i>Tambah Jurnal
                    </button>
                </div>
                
                <!-- Date Filter -->
                <div class="bg-white rounded-lg card-shadow p-6 mb-6">
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Dari Tanggal</label>
                            <input type="date" id="adminJournalStartDate" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Sampai Tanggal</label>
                            <input type="date" id="adminJournalEndDate" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div class="flex items-end">
                            <button onclick="filterAdminJournalData()" class="btn-primary text-white px-6 py-2 rounded-lg hover:shadow-lg transition-all">
                                <i class="fas fa-filter mr-2"></i>Filter
                            </button>
                        </div>
                        <div class="flex items-end">
                            <button onclick="printJournalReport()" class="bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700 transition-all">
                                <i class="fas fa-print mr-2"></i>Cetak Jurnal
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Journal Entries -->
                <div id="adminJournalEntriesList" class="space-y-6">
                    <!-- Journal entries will be populated here -->
                </div>
            </div>
        </main>
    </div>

    <!-- Pelatih Dashboard -->
    <div id="pelatihDashboard" class="hidden min-h-screen bg-gray-50">
        <!-- Header -->
        <header class="bg-white shadow-sm border-b">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex justify-between items-center py-4">
                    <div class="flex items-center">
                        <div class="w-10 h-10 bg-red-600 rounded-full flex items-center justify-center mr-3">
                            <i class="fas fa-flag text-white"></i>
                        </div>
                        <h1 class="text-xl font-semibold text-gray-800">Pelatih Dashboard</h1>
                    </div>
                    <div class="flex items-center space-x-4">
                        <button onclick="logout()" class="text-red-600 hover:text-red-800">
                            <i class="fas fa-sign-out-alt mr-2"></i>Keluar
                        </button>
                    </div>
                </div>
            </div>
        </header>

        <!-- Navigation -->
        <nav class="bg-white shadow-sm">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex space-x-8">
                    <button onclick="showPelatihSection('dataSiswa')" class="pelatih-nav-btn py-4 px-2 border-b-2 border-blue-500 text-blue-600">
                        <i class="fas fa-users mr-2"></i>Data Siswa
                    </button>
                    <button onclick="showPelatihSection('dataAbsensi')" class="pelatih-nav-btn py-4 px-2 border-b-2 border-transparent hover:border-blue-500 text-gray-600 hover:text-blue-600">
                        <i class="fas fa-chart-bar mr-2"></i>Data Absensi
                    </button>
                    <button onclick="showPelatihSection('jurnalKegiatan')" class="pelatih-nav-btn py-4 px-2 border-b-2 border-transparent hover:border-blue-500 text-gray-600 hover:text-blue-600">
                        <i class="fas fa-journal-whills mr-2"></i>Jurnal Kegiatan
                    </button>
                    <button onclick="showPelatihSection('tugasMateri')" class="pelatih-nav-btn py-4 px-2 border-b-2 border-transparent hover:border-blue-500 text-gray-600 hover:text-blue-600">
                        <i class="fas fa-book-open mr-2"></i>Tugas dan Materi Anggota
                    </button>
                    <button onclick="showPelatihSection('infoAkun')" class="pelatih-nav-btn py-4 px-2 border-b-2 border-transparent hover:border-blue-500 text-gray-600 hover:text-blue-600">
                        <i class="fas fa-user-cog mr-2"></i>Info Akun
                    </button>
                </div>
            </div>
        </nav>

        <!-- Pelatih Content -->
        <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
            <!-- Data Siswa Section -->
            <div id="dataSiswa" class="pelatih-section">
                <div class="mb-8">
                    <h2 class="text-2xl font-bold text-gray-800 mb-6">Data Siswa</h2>

                    <!-- Action Buttons -->
                    <div class="flex flex-wrap gap-4 mb-6">
                        <button onclick="showModal('addStudentModal')" class="btn-primary text-white px-4 py-2 rounded-lg hover:shadow-lg transition-all">
                            <i class="fas fa-plus mr-2"></i>Tambah Siswa
                        </button>
                        <button onclick="showModal('addFieldModal')" class="bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition-all">
                            <i class="fas fa-plus-circle mr-2"></i>Tambah Field Data
                        </button>
                        <button onclick="importFromSpreadsheet()" class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-all">
                            <i class="fas fa-file-import mr-2"></i>Import dari Spreadsheet
                        </button>
                        <button onclick="printData()" class="bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition-all">
                            <i class="fas fa-print mr-2"></i>Cetak Data
                        </button>
                    </div>

                    <!-- Class Tabs -->
                    <div class="mb-6">
                        <div class="flex space-x-4">
                            <button onclick="showClassTab('7')" class="class-tab-btn bg-green-600 text-white px-4 py-2 rounded-lg">
                                <i class="fas fa-users mr-2"></i>Kelas 7
                            </button>
                            <button onclick="showClassTab('8')" class="class-tab-btn bg-gray-300 text-gray-700 px-4 py-2 rounded-lg">
                                <i class="fas fa-users mr-2"></i>Kelas 8
                            </button>
                            <button onclick="showClassTab('9')" class="class-tab-btn bg-gray-300 text-gray-700 px-4 py-2 rounded-lg">
                                <i class="fas fa-users mr-2"></i>Kelas 9
                            </button>
                        </div>
                    </div>

                    <!-- Students Tables by Class -->
                    <div id="class7Students" class="class-students-section">
                        <div class="bg-white rounded-lg card-shadow overflow-hidden">
                            <div class="bg-green-50 px-6 py-3">
                                <h3 class="text-lg font-semibold text-green-800">Siswa Kelas 7</h3>
                            </div>
                            <table class="w-full">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Foto</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Nama</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">TTL</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Kelas</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Aksi</th>
                                    </tr>
                                </thead>
                                <tbody id="class7StudentsBody" class="bg-white divide-y divide-gray-200">
                                    <!-- Class 7 students will be populated here -->
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <div id="class8Students" class="class-students-section hidden">
                        <div class="bg-white rounded-lg card-shadow overflow-hidden">
                            <div class="bg-blue-50 px-6 py-3">
                                <h3 class="text-lg font-semibold text-blue-800">Siswa Kelas 8</h3>
                            </div>
                            <table class="w-full">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Foto</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Nama</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">TTL</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Kelas</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Aksi</th>
                                    </tr>
                                </thead>
                                <tbody id="class8StudentsBody" class="bg-white divide-y divide-gray-200">
                                    <!-- Class 8 students will be populated here -->
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <div id="class9Students" class="class-students-section hidden">
                        <div class="bg-white rounded-lg card-shadow overflow-hidden">
                            <div class="bg-purple-50 px-6 py-3">
                                <h3 class="text-lg font-semibold text-purple-800">Siswa Kelas 9</h3>
                            </div>
                            <table class="w-full">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Foto</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Nama</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">TTL</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Kelas</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Aksi</th>
                                    </tr>
                                </thead>
                                <tbody id="class9StudentsBody" class="bg-white divide-y divide-gray-200">
                                    <!-- Class 9 students will be populated here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Data Absensi Section -->
            <div id="dataAbsensi" class="pelatih-section hidden">
                <h2 class="text-2xl font-bold text-gray-800 mb-6">Data Absensi</h2>
                
                <!-- Date Range Filter -->
                <div class="bg-white rounded-lg card-shadow p-6 mb-6">
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Dari Tanggal</label>
                            <input type="date" id="startDate" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Sampai Tanggal</label>
                            <input type="date" id="endDate" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div class="flex items-end">
                            <button onclick="filterAttendanceData()" class="btn-primary text-white px-6 py-2 rounded-lg hover:shadow-lg transition-all">
                                <i class="fas fa-filter mr-2"></i>Filter
                            </button>
                        </div>
                        <div class="flex items-end">
                            <button onclick="printAttendanceReport()" class="bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700 transition-all">
                                <i class="fas fa-print mr-2"></i>Cetak Absensi
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Infografis Kehadiran Keseluruhan -->
                <div class="mb-8">
                    <h3 class="text-lg font-semibold text-gray-800 mb-4">Kehadiran Keseluruhan (Rentang Waktu)</h3>
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-6">
                        <div class="bg-white rounded-lg card-shadow p-6">
                            <div class="flex items-center">
                                <div class="w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center">
                                    <i class="fas fa-check text-green-600 text-xl"></i>
                                </div>
                                <div class="ml-4">
                                    <p class="text-sm text-gray-600">Hadir</p>
                                    <p class="text-2xl font-bold text-gray-800" id="totalHadir">85%</p>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white rounded-lg card-shadow p-6">
                            <div class="flex items-center">
                                <div class="w-12 h-12 bg-yellow-100 rounded-lg flex items-center justify-center">
                                    <i class="fas fa-exclamation text-yellow-600 text-xl"></i>
                                </div>
                                <div class="ml-4">
                                    <p class="text-sm text-gray-600">Izin</p>
                                    <p class="text-2xl font-bold text-gray-800" id="totalIzin">8%</p>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white rounded-lg card-shadow p-6">
                            <div class="flex items-center">
                                <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center">
                                    <i class="fas fa-thermometer text-blue-600 text-xl"></i>
                                </div>
                                <div class="ml-4">
                                    <p class="text-sm text-gray-600">Sakit</p>
                                    <p class="text-2xl font-bold text-gray-800" id="totalSakit">5%</p>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white rounded-lg card-shadow p-6">
                            <div class="flex items-center">
                                <div class="w-12 h-12 bg-red-100 rounded-lg flex items-center justify-center">
                                    <i class="fas fa-times text-red-600 text-xl"></i>
                                </div>
                                <div class="ml-4">
                                    <p class="text-sm text-gray-600">Alpha</p>
                                    <p class="text-2xl font-bold text-gray-800" id="totalAlpha">2%</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Infografis Kehadiran Hari Ini -->
                <div class="mb-8">
                    <h3 class="text-lg font-semibold text-gray-800 mb-4">Kehadiran Hari Ini</h3>
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-6">
                        <div class="bg-white rounded-lg card-shadow p-6">
                            <div class="flex items-center">
                                <div class="w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center">
                                    <i class="fas fa-check text-green-600 text-xl"></i>
                                </div>
                                <div class="ml-4">
                                    <p class="text-sm text-gray-600">Hadir</p>
                                    <p class="text-2xl font-bold text-gray-800" id="todayHadir">4</p>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white rounded-lg card-shadow p-6">
                            <div class="flex items-center">
                                <div class="w-12 h-12 bg-yellow-100 rounded-lg flex items-center justify-center">
                                    <i class="fas fa-exclamation text-yellow-600 text-xl"></i>
                                </div>
                                <div class="ml-4">
                                    <p class="text-sm text-gray-600">Izin</p>
                                    <p class="text-2xl font-bold text-gray-800" id="todayIzin">1</p>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white rounded-lg card-shadow p-6">
                            <div class="flex items-center">
                                <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center">
                                    <i class="fas fa-thermometer text-blue-600 text-xl"></i>
                                </div>
                                <div class="ml-4">
                                    <p class="text-sm text-gray-600">Sakit</p>
                                    <p class="text-2xl font-bold text-gray-800" id="todaySakit">0</p>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white rounded-lg card-shadow p-6">
                            <div class="flex items-center">
                                <div class="w-12 h-12 bg-red-100 rounded-lg flex items-center justify-center">
                                    <i class="fas fa-times text-red-600 text-xl"></i>
                                </div>
                                <div class="ml-4">
                                    <p class="text-sm text-gray-600">Alpha</p>
                                    <p class="text-2xl font-bold text-gray-800" id="todayAlpha">0</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Attendance Chart -->
                <div class="bg-white rounded-lg card-shadow p-6">
                    <h3 class="text-lg font-semibold text-gray-800 mb-4">Grafik Kehadiran</h3>
                    <canvas id="attendanceOverviewChart" width="400" height="200"></canvas>
                </div>
            </div>

            <!-- Jurnal Kegiatan Section -->
            <div id="jurnalKegiatan" class="pelatih-section hidden">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold text-gray-800">Jurnal Kegiatan</h2>
                    <div class="text-sm text-gray-600">
                        <i class="fas fa-info-circle mr-1"></i>
                        Pantau dan edit jurnal yang dibuat oleh admin
                    </div>
                </div>
                
                <!-- Date Filter -->
                <div class="bg-white rounded-lg card-shadow p-6 mb-6">
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Dari Tanggal</label>
                            <input type="date" id="pelatihJournalStartDate" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Sampai Tanggal</label>
                            <input type="date" id="pelatihJournalEndDate" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div class="flex items-end">
                            <button onclick="filterPelatihJournalData()" class="btn-primary text-white px-6 py-2 rounded-lg hover:shadow-lg transition-all">
                                <i class="fas fa-filter mr-2"></i>Filter
                            </button>
                        </div>
                        <div class="flex items-end">
                            <button onclick="printJournalReport()" class="bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700 transition-all">
                                <i class="fas fa-print mr-2"></i>Cetak Jurnal
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Journal Entries -->
                <div id="pelatihJournalEntriesList" class="space-y-6">
                    <!-- Journal entries will be populated here -->
                </div>
            </div>

            <!-- Tugas dan Materi Anggota Section -->
            <div id="tugasMateri" class="pelatih-section hidden">
                <h2 class="text-2xl font-bold text-gray-800 mb-6">Tugas dan Materi Anggota</h2>
                
                <!-- Sub Navigation -->
                <div class="mb-6">
                    <div class="flex space-x-4">
                        <button onclick="showTugasMateriTab('tugas')" class="tugas-materi-tab-btn bg-blue-600 text-white px-4 py-2 rounded-lg">
                            <i class="fas fa-tasks mr-2"></i>Tugas
                        </button>
                        <button onclick="showTugasMateriTab('materi')" class="tugas-materi-tab-btn bg-gray-300 text-gray-700 px-4 py-2 rounded-lg">
                            <i class="fas fa-book mr-2"></i>Materi
                        </button>
                        <button onclick="showTugasMateriTab('laporan')" class="tugas-materi-tab-btn bg-gray-300 text-gray-700 px-4 py-2 rounded-lg">
                            <i class="fas fa-chart-line mr-2"></i>Laporan Siswa
                        </button>
                    </div>
                </div>

                <!-- Tugas Tab -->
                <div id="tugasTab" class="tugas-materi-content">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-lg font-semibold text-gray-800">Manajemen Tugas</h3>
                        <button onclick="showModal('addAssignmentModal')" class="btn-primary text-white px-4 py-2 rounded-lg hover:shadow-lg transition-all">
                            <i class="fas fa-plus mr-2"></i>Tambah Tugas
                        </button>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="assignmentsList">
                        <!-- Assignments will be populated here -->
                    </div>
                </div>

                <!-- Materi Tab -->
                <div id="materiTab" class="tugas-materi-content hidden">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-lg font-semibold text-gray-800">Manajemen Materi</h3>
                        <button onclick="showModal('addMaterialModal')" class="btn-primary text-white px-4 py-2 rounded-lg hover:shadow-lg transition-all">
                            <i class="fas fa-plus mr-2"></i>Tambah Materi
                        </button>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="coachMaterialsList">
                        <!-- Materials will be populated here -->
                    </div>
                </div>

                <!-- Laporan Tab -->
                <div id="laporanTab" class="tugas-materi-content hidden">
                    <h3 class="text-lg font-semibold text-gray-800 mb-6">Laporan Tugas per Siswa</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4" id="individualReports">
                        <!-- Individual reports will be populated here -->
                    </div>
                </div>
            </div>

            <!-- Info Akun Section -->
            <div id="infoAkun" class="pelatih-section hidden">
                <h2 class="text-2xl font-bold text-gray-800 mb-6">Info Akun</h2>
                
                <!-- Account Management Tabs -->
                <div class="mb-6">
                    <div class="flex space-x-4">
                        <button onclick="showInfoAkunTab('pelatih')" class="info-akun-tab-btn bg-blue-600 text-white px-4 py-2 rounded-lg">
                            <i class="fas fa-user-tie mr-2"></i>Akun Pelatih
                        </button>
                        <button onclick="showInfoAkunTab('admin')" class="info-akun-tab-btn bg-gray-300 text-gray-700 px-4 py-2 rounded-lg">
                            <i class="fas fa-user-shield mr-2"></i>Kelola Admin
                        </button>
                        <button onclick="showInfoAkunTab('aktivitas')" class="info-akun-tab-btn bg-gray-300 text-gray-700 px-4 py-2 rounded-lg">
                            <i class="fas fa-chart-line mr-2"></i>Aktivitas Akun
                        </button>
                    </div>
                </div>

                <!-- Pelatih Account Tab -->
                <div id="pelatihInfoTab" class="info-akun-content">
                    <div class="bg-white rounded-lg card-shadow p-6">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">Informasi Akun Pelatih</h3>
                        
                        <!-- Current Coach Info -->
                        <div class="bg-blue-50 rounded-lg p-4 mb-6">
                            <h4 class="font-medium text-gray-800 mb-2">Info Login Saat Ini:</h4>
                            <div class="space-y-1 text-sm">
                                <div><span class="text-gray-600">Username:</span> <span class="font-medium" id="currentPelatihUsername">Munfasa</span></div>
                                <div><span class="text-gray-600">Password:</span> <span class="font-medium">‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢</span></div>
                            </div>
                        </div>
                        
                        <form id="updatePelatihForm" class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Username Baru</label>
                                <input type="text" id="newPelatihUsername" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" required>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Password Baru</label>
                                <div class="relative">
                                    <input type="password" id="newPelatihPassword" class="w-full px-4 py-2 pr-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" required>
                                    <button type="button" onclick="togglePasswordVisibility('newPelatihPassword')" class="absolute inset-y-0 right-0 pr-3 flex items-center">
                                        <i id="newPelatihPassword-icon" class="fas fa-eye text-gray-400 hover:text-gray-600"></i>
                                    </button>
                                </div>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Konfirmasi Password Baru</label>
                                <div class="relative">
                                    <input type="password" id="confirmPelatihPassword" class="w-full px-4 py-2 pr-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" required>
                                    <button type="button" onclick="togglePasswordVisibility('confirmPelatihPassword')" class="absolute inset-y-0 right-0 pr-3 flex items-center">
                                        <i id="confirmPelatihPassword-icon" class="fas fa-eye text-gray-400 hover:text-gray-600"></i>
                                    </button>
                                </div>
                            </div>
                            <button type="submit" class="w-full btn-primary text-white py-2 rounded-lg hover:shadow-lg transition-all">
                                <i class="fas fa-save mr-2"></i>Update Akun Pelatih
                            </button>
                        </form>
                    </div>
                </div>

                <!-- Admin Management Tab -->
                <div id="adminInfoTab" class="info-akun-content hidden">
                    <div class="bg-white rounded-lg card-shadow p-6">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">Kelola Akun Admin</h3>
                        
                        <!-- Current Admin Accounts List -->
                        <div class="bg-green-50 rounded-lg p-4 mb-6">
                            <h4 class="font-medium text-gray-800 mb-3">Daftar Akun Admin:</h4>
                            <div id="pelatihAdminAccountsList" class="space-y-2">
                                <!-- Admin accounts will be populated here -->
                            </div>
                        </div>

                        <!-- Add New Admin Form -->
                        <div class="border-t pt-4">
                            <h4 class="font-medium text-gray-800 mb-4">Tambah Akun Admin Baru:</h4>
                            <form id="pelatihAddAdminForm" class="space-y-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Username Admin</label>
                                    <input type="text" id="pelatihNewAdminUsername" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" required>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Password Admin</label>
                                    <div class="relative">
                                        <input type="password" id="pelatihNewAdminPassword" class="w-full px-4 py-2 pr-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" required>
                                        <button type="button" onclick="togglePasswordVisibility('pelatihNewAdminPassword')" class="absolute inset-y-0 right-0 pr-3 flex items-center">
                                            <i id="pelatihNewAdminPassword-icon" class="fas fa-eye text-gray-400 hover:text-gray-600"></i>
                                        </button>
                                    </div>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Konfirmasi Password</label>
                                    <div class="relative">
                                        <input type="password" id="pelatihConfirmAdminPassword" class="w-full px-4 py-2 pr-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" required>
                                        <button type="button" onclick="togglePasswordVisibility('pelatihConfirmAdminPassword')" class="absolute inset-y-0 right-0 pr-3 flex items-center">
                                            <i id="pelatihConfirmAdminPassword-icon" class="fas fa-eye text-gray-400 hover:text-gray-600"></i>
                                        </button>
                                    </div>
                                </div>
                                <button type="submit" class="w-full bg-green-600 text-white py-2 rounded-lg hover:bg-green-700 transition-all">
                                    <i class="fas fa-plus mr-2"></i>Tambah Admin
                                </button>
                            </form>
                        </div>
                    </div>
                </div>

                <!-- Account Activities Tab -->
                <div id="aktivitasInfoTab" class="info-akun-content hidden">
                    <div class="bg-white rounded-lg card-shadow p-6">
                        <h3 class="text-lg font-semibold text-gray-800 mb-6">Aktivitas Akun</h3>
                        
                        <!-- Activity Filter -->
                        <div class="mb-6">
                            <div class="flex space-x-4">
                                <button onclick="showActivityTypeTab('admin')" class="activity-type-tab-btn bg-blue-600 text-white px-4 py-2 rounded-lg">
                                    <i class="fas fa-user-shield mr-2"></i>Admin
                                </button>
                                <button onclick="showActivityTypeTab('siswa')" class="activity-type-tab-btn bg-gray-300 text-gray-700 px-4 py-2 rounded-lg">
                                    <i class="fas fa-user-graduate mr-2"></i>Siswa
                                </button>
                                <button onclick="showActivityTypeTab('semua')" class="activity-type-tab-btn bg-gray-300 text-gray-700 px-4 py-2 rounded-lg">
                                    <i class="fas fa-list mr-2"></i>Semua
                                </button>
                            </div>
                        </div>

                        <!-- Date Filter -->
                        <div class="bg-gray-50 rounded-lg p-4 mb-6">
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Dari Tanggal</label>
                                    <input type="date" id="activityStartDate" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Sampai Tanggal</label>
                                    <input type="date" id="activityEndDate" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                                </div>
                                <div class="flex items-end">
                                    <button onclick="filterAccountActivities()" class="btn-primary text-white px-6 py-2 rounded-lg hover:shadow-lg transition-all">
                                        <i class="fas fa-filter mr-2"></i>Filter
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Activity Statistics -->
                        <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
                            <div class="bg-blue-50 rounded-lg p-4">
                                <div class="flex items-center">
                                    <div class="w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center">
                                        <i class="fas fa-sign-in-alt text-blue-600"></i>
                                    </div>
                                    <div class="ml-3">
                                        <p class="text-sm text-gray-600">Login Hari Ini</p>
                                        <p class="text-xl font-bold text-gray-800" id="todayLogins">12</p>
                                    </div>
                                </div>
                            </div>
                            <div class="bg-green-50 rounded-lg p-4">
                                <div class="flex items-center">
                                    <div class="w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center">
                                        <i class="fas fa-tasks text-green-600"></i>
                                    </div>
                                    <div class="ml-3">
                                        <p class="text-sm text-gray-600">Tugas Submit</p>
                                        <p class="text-xl font-bold text-gray-800" id="todaySubmissions">8</p>
                                    </div>
                                </div>
                            </div>
                            <div class="bg-purple-50 rounded-lg p-4">
                                <div class="flex items-center">
                                    <div class="w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center">
                                        <i class="fas fa-download text-purple-600"></i>
                                    </div>
                                    <div class="ml-3">
                                        <p class="text-sm text-gray-600">Download Materi</p>
                                        <p class="text-xl font-bold text-gray-800" id="todayDownloads">15</p>
                                    </div>
                                </div>
                            </div>
                            <div class="bg-orange-50 rounded-lg p-4">
                                <div class="flex items-center">
                                    <div class="w-10 h-10 bg-orange-100 rounded-lg flex items-center justify-center">
                                        <i class="fas fa-clipboard-check text-orange-600"></i>
                                    </div>
                                    <div class="ml-3">
                                        <p class="text-sm text-gray-600">Absensi Input</p>
                                        <p class="text-xl font-bold text-gray-800" id="todayAttendance">3</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Admin Activities -->
                        <div id="adminActivitiesTab" class="activity-type-content">
                            <h4 class="font-semibold text-gray-800 mb-4">Aktivitas Admin</h4>
                            <div class="bg-gray-50 rounded-lg max-h-96 overflow-y-auto">
                                <div id="adminActivitiesList" class="space-y-2 p-4">
                                    <!-- Admin activities will be populated here -->
                                </div>
                            </div>
                        </div>

                        <!-- Student Activities -->
                        <div id="siswaActivitiesTab" class="activity-type-content hidden">
                            <h4 class="font-semibold text-gray-800 mb-4">Aktivitas Siswa</h4>
                            <div class="bg-gray-50 rounded-lg max-h-96 overflow-y-auto">
                                <div id="siswaActivitiesList" class="space-y-2 p-4">
                                    <!-- Student activities will be populated here -->
                                </div>
                            </div>
                        </div>

                        <!-- All Activities -->
                        <div id="semuaActivitiesTab" class="activity-type-content hidden">
                            <h4 class="font-semibold text-gray-800 mb-4">Semua Aktivitas</h4>
                            <div class="bg-gray-50 rounded-lg max-h-96 overflow-y-auto">
                                <div id="semuaActivitiesList" class="space-y-2 p-4">
                                    <!-- All activities will be populated here -->
                                </div>
                            </div>
                        </div>

                        <!-- Export Options -->
                        <div class="flex justify-end space-x-4 mt-6 pt-4 border-t">
                            <button onclick="exportActivitiesToCSV()" class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700">
                                <i class="fas fa-file-csv mr-2"></i>Export CSV
                            </button>
                            <button onclick="printActivitiesReport()" class="bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700">
                                <i class="fas fa-print mr-2"></i>Cetak Laporan
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Jurnal Kegiatan Section for Admin -->
            <div id="jurnalKegiatan" class="admin-section hidden">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold text-gray-800">Jurnal Kegiatan</h2>
                    <button onclick="showModal('addJournalModal')" class="btn-primary text-white px-4 py-2 rounded-lg hover:shadow-lg transition-all">
                        <i class="fas fa-plus mr-2"></i>Tambah Jurnal
                    </button>
                </div>
                
                <!-- Date Filter -->
                <div class="bg-white rounded-lg card-shadow p-6 mb-6">
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Dari Tanggal</label>
                            <input type="date" id="adminJournalStartDate" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Sampai Tanggal</label>
                            <input type="date" id="adminJournalEndDate" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div class="flex items-end">
                            <button onclick="filterAdminJournalData()" class="btn-primary text-white px-6 py-2 rounded-lg hover:shadow-lg transition-all">
                                <i class="fas fa-filter mr-2"></i>Filter
                            </button>
                        </div>
                        <div class="flex items-end">
                            <button onclick="printJournalReport()" class="bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700 transition-all">
                                <i class="fas fa-print mr-2"></i>Cetak Jurnal
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Journal Entries -->
                <div id="adminJournalEntriesList" class="space-y-6">
                    <!-- Journal entries will be populated here -->
                </div>
            </div>
        </main>
    </div>

    <!-- Student Dashboard -->
    <div id="studentDashboard" class="hidden min-h-screen bg-gray-50">
        <!-- Header -->
        <header class="bg-white shadow-sm border-b">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex justify-between items-center py-4">
                    <div class="flex items-center">
                        <div class="w-10 h-10 bg-red-600 rounded-full flex items-center justify-center mr-3">
                            <i class="fas fa-flag text-white"></i>
                        </div>
                        <h1 class="text-xl font-semibold text-gray-800">Dashboard Siswa</h1>
                    </div>
                    <div class="flex items-center space-x-4">
                        <button onclick="logout()" class="text-red-600 hover:text-red-800">
                            <i class="fas fa-sign-out-alt mr-2"></i>Keluar
                        </button>
                    </div>
                </div>
            </div>
        </header>

        <!-- Navigation -->
        <nav class="bg-white shadow-sm">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex space-x-8">
                    <button onclick="showStudentSection('profil')" class="student-nav-btn py-4 px-2 border-b-2 border-blue-500 text-blue-600">
                        <i class="fas fa-user mr-2"></i>Profil
                    </button>
                    <button onclick="showStudentSection('kehadiran')" class="student-nav-btn py-4 px-2 border-b-2 border-transparent hover:border-blue-500 text-gray-600 hover:text-blue-600">
                        <i class="fas fa-chart-line mr-2"></i>Kehadiran
                    </button>
                    <button onclick="showStudentSection('materi')" class="student-nav-btn py-4 px-2 border-b-2 border-transparent hover:border-blue-500 text-gray-600 hover:text-blue-600">
                        <i class="fas fa-book mr-2"></i>Materi
                    </button>
                    <button onclick="showStudentSection('tugas')" class="student-nav-btn py-4 px-2 border-b-2 border-transparent hover:border-blue-500 text-gray-600 hover:text-blue-600">
                        <i class="fas fa-tasks mr-2"></i>Tugas
                    </button>
                </div>
            </div>
        </nav>

        <!-- Student Content -->
        <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
            <!-- Profil Section -->
            <div id="profil" class="student-section">
                <h2 class="text-2xl font-bold text-gray-800 mb-6">Profil Siswa</h2>
                
                <!-- Student Profile Card -->
                <div class="bg-white rounded-lg card-shadow p-6 mb-6">
                    <div class="flex items-center mb-6">
                        <div class="w-24 h-24 bg-blue-100 rounded-full flex items-center justify-center text-4xl mr-6">
                            üë®‚Äçüéì
                        </div>
                        <div>
                            <h3 class="text-2xl font-semibold text-gray-800" id="studentProfileName">Ahmad Rizki</h3>
                            <p class="text-gray-600" id="studentProfileClass">Kelas 9A</p>
                            <p class="text-sm text-gray-500" id="studentProfileId">ID: 2024001</p>
                        </div>
                    </div>
                    
                    <!-- Profile Details -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <h4 class="font-semibold text-gray-800 mb-4">Data Pribadi</h4>
                            <div class="space-y-3">
                                <div>
                                    <label class="text-sm text-gray-600">Nama Lengkap</label>
                                    <p class="font-medium text-gray-800" id="profileFullName">Ahmad Rizki</p>
                                </div>
                                <div>
                                    <label class="text-sm text-gray-600">Tempat, Tanggal Lahir</label>
                                    <p class="font-medium text-gray-800" id="profileBirthInfo">Lamongan, 15 Mei 2008</p>
                                </div>
                                <div>
                                    <label class="text-sm text-gray-600">Kelas</label>
                                    <p class="font-medium text-gray-800" id="profileClass">9A</p>
                                </div>
                                <div>
                                    <label class="text-sm text-gray-600">Nama Orangtua</label>
                                    <p class="font-medium text-gray-800" id="profileParentName">Budi Rizki</p>
                                </div>
                            </div>
                        </div>
                        
                        <div>
                            <h4 class="font-semibold text-gray-800 mb-4">Informasi Akun</h4>
                            <div class="space-y-3">
                                <div>
                                    <label class="text-sm text-gray-600">Username</label>
                                    <p class="font-medium text-gray-800" id="profileUsername">ahmad.rizki</p>
                                </div>
                                <div>
                                    <label class="text-sm text-gray-600">Status</label>
                                    <span class="bg-green-100 text-green-800 px-2 py-1 rounded-full text-sm font-medium">Aktif</span>
                                </div>
                                <div>
                                    <label class="text-sm text-gray-600">Bergabung Sejak</label>
                                    <p class="font-medium text-gray-800">Juli 2024</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Change Password Section -->
                <div class="bg-white rounded-lg card-shadow p-6">
                    <h3 class="text-lg font-semibold text-gray-800 mb-4">Ganti Password</h3>
                    <form id="changePasswordForm" class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Password Lama</label>
                            <div class="relative">
                                <input type="password" id="oldPassword" class="w-full px-4 py-2 pr-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" required>
                                <button type="button" onclick="togglePasswordVisibility('oldPassword')" class="absolute inset-y-0 right-0 pr-3 flex items-center">
                                    <i id="oldPassword-icon" class="fas fa-eye text-gray-400 hover:text-gray-600"></i>
                                </button>
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Password Baru</label>
                            <div class="relative">
                                <input type="password" id="newPassword" class="w-full px-4 py-2 pr-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" required>
                                <button type="button" onclick="togglePasswordVisibility('newPassword')" class="absolute inset-y-0 right-0 pr-3 flex items-center">
                                    <i id="newPassword-icon" class="fas fa-eye text-gray-400 hover:text-gray-600"></i>
                                </button>
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Konfirmasi Password Baru</label>
                            <div class="relative">
                                <input type="password" id="confirmPassword" class="w-full px-4 py-2 pr-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" required>
                                <button type="button" onclick="togglePasswordVisibility('confirmPassword')" class="absolute inset-y-0 right-0 pr-3 flex items-center">
                                    <i id="confirmPassword-icon" class="fas fa-eye text-gray-400 hover:text-gray-600"></i>
                                </button>
                            </div>
                        </div>
                        <button type="submit" class="btn-primary text-white px-6 py-2 rounded-lg hover:shadow-lg transition-all">
                            <i class="fas fa-key mr-2"></i>Ganti Password
                        </button>
                    </form>
                </div>
            </div>

            <!-- Dashboard Kehadiran -->
            <div id="kehadiran" class="student-section">
                <h2 class="text-2xl font-bold text-gray-800 mb-6">Dashboard Kehadiran</h2>
                
                <!-- Attendance Stats -->
                <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                    <div class="bg-white rounded-lg card-shadow p-6">
                        <div class="flex items-center">
                            <div class="w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center">
                                <i class="fas fa-check text-green-600 text-xl"></i>
                            </div>
                            <div class="ml-4">
                                <p class="text-sm text-gray-600">Hadir</p>
                                <p class="text-2xl font-bold text-gray-800">24</p>
                            </div>
                        </div>
                    </div>
                    <div class="bg-white rounded-lg card-shadow p-6">
                        <div class="flex items-center">
                            <div class="w-12 h-12 bg-yellow-100 rounded-lg flex items-center justify-center">
                                <i class="fas fa-exclamation text-yellow-600 text-xl"></i>
                            </div>
                            <div class="ml-4">
                                <p class="text-sm text-gray-600">Izin</p>
                                <p class="text-2xl font-bold text-gray-800">2</p>
                            </div>
                        </div>
                    </div>
                    <div class="bg-white rounded-lg card-shadow p-6">
                        <div class="flex items-center">
                            <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center">
                                <i class="fas fa-thermometer text-blue-600 text-xl"></i>
                            </div>
                            <div class="ml-4">
                                <p class="text-sm text-gray-600">Sakit</p>
                                <p class="text-2xl font-bold text-gray-800">1</p>
                            </div>
                        </div>
                    </div>
                    <div class="bg-white rounded-lg card-shadow p-6">
                        <div class="flex items-center">
                            <div class="w-12 h-12 bg-red-100 rounded-lg flex items-center justify-center">
                                <i class="fas fa-times text-red-600 text-xl"></i>
                            </div>
                            <div class="ml-4">
                                <p class="text-sm text-gray-600">Alpha</p>
                                <p class="text-2xl font-bold text-gray-800">0</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Attendance Chart -->
                <div class="bg-white rounded-lg card-shadow p-6">
                    <h3 class="text-lg font-semibold text-gray-800 mb-4">Grafik Kehadiran Bulanan</h3>
                    <canvas id="attendanceChart" width="400" height="200"></canvas>
                </div>
            </div>

            <!-- Materi Section -->
            <div id="materi" class="student-section hidden">
                <h2 class="text-2xl font-bold text-gray-800 mb-6">Materi Pembelajaran</h2>
                
                <!-- Materials List -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="materialsList">
                    <!-- Materials will be populated here -->
                </div>
            </div>

            <!-- Tugas Section -->
            <div id="tugas" class="student-section hidden">
                <h2 class="text-2xl font-bold text-gray-800 mb-6">Tugas</h2>
                
                <!-- Available Assignments -->
                <div id="availableAssignments" class="bg-white rounded-lg card-shadow p-6 mb-6">
                    <h3 class="text-lg font-semibold text-gray-800 mb-4">Pilih Tugas untuk Dikerjakan</h3>
                    <div id="assignmentSelectionList" class="space-y-4">
                        <!-- Available assignments will be populated here -->
                    </div>
                </div>

                <!-- Submit Assignment Form -->
                <div id="submitAssignmentSection" class="hidden bg-white rounded-lg card-shadow p-6 mb-6">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-lg font-semibold text-gray-800">Submit Tugas</h3>
                        <button onclick="hideSubmitForm()" class="text-gray-400 hover:text-gray-600">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    
                    <!-- Selected Assignment Info -->
                    <div id="selectedAssignmentInfo" class="bg-blue-50 rounded-lg p-4 mb-4">
                        <!-- Selected assignment info will be shown here -->
                    </div>
                    
                    <form id="submitAssignmentForm" class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Jawaban Tugas</label>
                            <textarea id="assignmentAnswer" rows="6" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" placeholder="Tulis jawaban tugas di sini..." required></textarea>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Upload File (Opsional)</label>
                            <input type="file" id="assignmentFile" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                        </div>
                        <button type="submit" class="btn-primary text-white px-6 py-2 rounded-lg hover:shadow-lg transition-all">
                            <i class="fas fa-upload mr-2"></i>Submit Tugas
                        </button>
                    </form>
                </div>

                <!-- Assignment Progress -->
                <div class="bg-white rounded-lg card-shadow p-6">
                    <h3 class="text-lg font-semibold text-gray-800 mb-4">Progres Tugas</h3>
                    <div id="studentAssignmentsList" class="space-y-4">
                        <!-- Student assignments will be populated here -->
                    </div>
                </div>
            </div>

            <!-- Jurnal Kegiatan Section for Admin -->
            <div id="jurnalKegiatan" class="admin-section hidden">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold text-gray-800">Jurnal Kegiatan</h2>
                    <button onclick="showModal('addJournalModal')" class="btn-primary text-white px-4 py-2 rounded-lg hover:shadow-lg transition-all">
                        <i class="fas fa-plus mr-2"></i>Tambah Jurnal
                    </button>
                </div>
                
                <!-- Date Filter -->
                <div class="bg-white rounded-lg card-shadow p-6 mb-6">
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Dari Tanggal</label>
                            <input type="date" id="adminJournalStartDate" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Sampai Tanggal</label>
                            <input type="date" id="adminJournalEndDate" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div class="flex items-end">
                            <button onclick="filterAdminJournalData()" class="btn-primary text-white px-6 py-2 rounded-lg hover:shadow-lg transition-all">
                                <i class="fas fa-filter mr-2"></i>Filter
                            </button>
                        </div>
                        <div class="flex items-end">
                            <button onclick="printJournalReport()" class="bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700 transition-all">
                                <i class="fas fa-print mr-2"></i>Cetak Jurnal
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Journal Entries -->
                <div id="adminJournalEntriesList" class="space-y-6">
                    <!-- Journal entries will be populated here -->
                </div>
            </div>
        </main>
    </div>

    <!-- Modals -->
    <!-- Edit Student Modal -->
    <div id="editStudentModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
        <div class="bg-white rounded-lg card-shadow p-6 w-full max-w-md">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-semibold text-gray-800">Edit Data Siswa</h3>
                <button onclick="hideModal('editStudentModal')" class="text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form id="editStudentForm" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Nama Lengkap</label>
                    <input type="text" id="editStudentName" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" required>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Kelas</label>
                    <select id="editStudentClass" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" required>
                        <option value="">Pilih Kelas</option>
                        <option value="7A">7A</option>
                        <option value="7B">7B</option>
                        <option value="8A">8A</option>
                        <option value="8B">8B</option>
                        <option value="9A">9A</option>
                        <option value="9B">9B</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Tempat Lahir</label>
                    <input type="text" id="editBirthPlace" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" required>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Tanggal Lahir</label>
                    <input type="date" id="editBirthDate" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" required>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Nama Orangtua</label>
                    <input type="text" id="editParentName" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" required>
                </div>
                <div class="flex space-x-4">
                    <button type="button" onclick="hideModal('editStudentModal')" class="flex-1 bg-gray-300 text-gray-700 py-2 rounded-lg hover:bg-gray-400 transition-all">
                        Batal
                    </button>
                    <button type="submit" class="flex-1 btn-primary text-white py-2 rounded-lg hover:shadow-lg transition-all">
                        Simpan Perubahan
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Student Modal -->
    <div id="addStudentModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
        <div class="bg-white rounded-lg card-shadow p-6 w-full max-w-md">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-semibold text-gray-800">Tambah Siswa Baru</h3>
                <button onclick="hideModal('addStudentModal')" class="text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form id="addStudentForm" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Nama Lengkap</label>
                    <input type="text" id="studentName" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" required>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Kelas</label>
                    <select id="studentClass" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" required>
                        <option value="">Pilih Kelas</option>
                        <option value="7A">7A</option>
                        <option value="7B">7B</option>
                        <option value="8A">8A</option>
                        <option value="8B">8B</option>
                        <option value="9A">9A</option>
                        <option value="9B">9B</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Tempat Lahir</label>
                    <input type="text" id="birthPlace" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" required>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Tanggal Lahir</label>
                    <input type="date" id="birthDate" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" required>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Nama Orangtua</label>
                    <input type="text" id="parentName" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" required>
                </div>
                <div id="additionalFields">
                    <!-- Additional fields will be added here -->
                </div>
                <div class="flex space-x-4">
                    <button type="button" onclick="hideModal('addStudentModal')" class="flex-1 bg-gray-300 text-gray-700 py-2 rounded-lg hover:bg-gray-400 transition-all">
                        Batal
                    </button>
                    <button type="submit" class="flex-1 btn-primary text-white py-2 rounded-lg hover:shadow-lg transition-all">
                        Simpan
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Field Modal -->
    <div id="addFieldModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
        <div class="bg-white rounded-lg card-shadow p-6 w-full max-w-md">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-semibold text-gray-800">Tambah Field Data Baru</h3>
                <button onclick="hideModal('addFieldModal')" class="text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form id="addFieldForm" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Nama Field</label>
                    <input type="text" id="fieldName" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" placeholder="Contoh: No. HP, Alamat, dll" required>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Tipe Field</label>
                    <select id="fieldType" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" required>
                        <option value="text">Text</option>
                        <option value="number">Number</option>
                        <option value="email">Email</option>
                        <option value="tel">Telephone</option>
                        <option value="date">Date</option>
                    </select>
                </div>
                <div class="flex space-x-4">
                    <button type="button" onclick="hideModal('addFieldModal')" class="flex-1 bg-gray-300 text-gray-700 py-2 rounded-lg hover:bg-gray-400 transition-all">
                        Batal
                    </button>
                    <button type="submit" class="flex-1 btn-primary text-white py-2 rounded-lg hover:shadow-lg transition-all">
                        Tambah Field
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Assignment Modal -->
    <div id="addAssignmentModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
        <div class="bg-white rounded-lg card-shadow p-6 w-full max-w-md">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-semibold text-gray-800">Tambah Tugas Baru</h3>
                <button onclick="hideModal('addAssignmentModal')" class="text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form id="addAssignmentForm" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Judul Tugas</label>
                    <input type="text" id="newAssignmentTitle" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" required>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Deskripsi</label>
                    <textarea id="newAssignmentDescription" rows="4" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" required></textarea>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Deadline</label>
                    <input type="date" id="newAssignmentDeadline" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" required>
                </div>
                <div class="flex space-x-4">
                    <button type="button" onclick="hideModal('addAssignmentModal')" class="flex-1 bg-gray-300 text-gray-700 py-2 rounded-lg hover:bg-gray-400 transition-all">
                        Batal
                    </button>
                    <button type="submit" class="flex-1 btn-primary text-white py-2 rounded-lg hover:shadow-lg transition-all">
                        Tambah Tugas
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Assignment Detail Modal -->
    <div id="assignmentDetailModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
        <div class="bg-white rounded-lg card-shadow p-6 w-full max-w-4xl max-h-[90vh] overflow-y-auto">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-semibold text-gray-800">Detail Tugas</h3>
                <button onclick="hideModal('assignmentDetailModal')" class="text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div id="assignmentDetailContent">
                <!-- Assignment detail content will be populated here -->
            </div>
        </div>
    </div>

    <!-- Add Material Modal -->
    <div id="addMaterialModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
        <div class="bg-white rounded-lg card-shadow p-6 w-full max-w-md">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-semibold text-gray-800">Tambah Materi Baru</h3>
                <button onclick="hideModal('addMaterialModal')" class="text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form id="addMaterialForm" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Judul Materi</label>
                    <input type="text" id="materialTitle" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" required>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Deskripsi</label>
                    <textarea id="materialDescription" rows="3" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" required></textarea>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Upload File</label>
                    <input type="file" id="materialFile" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" accept=".pdf,.doc,.docx,.ppt,.pptx,.mp4,.avi,.mov" required>
                </div>
                <div class="flex space-x-4">
                    <button type="button" onclick="hideModal('addMaterialModal')" class="flex-1 bg-gray-300 text-gray-700 py-2 rounded-lg hover:bg-gray-400 transition-all">
                        Batal
                    </button>
                    <button type="submit" class="flex-1 btn-primary text-white py-2 rounded-lg hover:shadow-lg transition-all">
                        Tambah Materi
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Edit Photo Modal -->
    <div id="editPhotoModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
        <div class="bg-white rounded-lg card-shadow p-6 w-full max-w-md">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-semibold text-gray-800">Edit Foto Siswa</h3>
                <button onclick="hideModal('editPhotoModal')" class="text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="text-center mb-4">
                <div id="currentPhotoDisplay" class="text-6xl mb-4">üë®‚Äçüéì</div>
                <p class="text-sm text-gray-600">Foto saat ini</p>
            </div>
            
            <!-- Photo Options -->
            <div class="mb-4">
                <div class="flex space-x-2 mb-4">
                    <button onclick="showPhotoOption('emoji')" class="photo-option-btn flex-1 bg-blue-600 text-white py-2 rounded-lg">
                        <i class="fas fa-smile mr-2"></i>Emoji
                    </button>
                    <button onclick="showPhotoOption('upload')" class="photo-option-btn flex-1 bg-gray-300 text-gray-700 py-2 rounded-lg">
                        <i class="fas fa-upload mr-2"></i>Upload
                    </button>
                    <button onclick="showPhotoOption('camera')" class="photo-option-btn flex-1 bg-gray-300 text-gray-700 py-2 rounded-lg">
                        <i class="fas fa-camera mr-2"></i>Kamera
                    </button>
                </div>
            </div>
            
            <form id="editPhotoForm" class="space-y-4">
                <!-- Emoji Selection -->
                <div id="emojiSelection" class="photo-option-content">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Pilih Emoji</label>
                    <div class="grid grid-cols-4 gap-2">
                        <button type="button" onclick="selectEmoji('üë®‚Äçüéì')" class="emoji-btn text-3xl p-2 border rounded hover:bg-gray-100">üë®‚Äçüéì</button>
                        <button type="button" onclick="selectEmoji('üë©‚Äçüéì')" class="emoji-btn text-3xl p-2 border rounded hover:bg-gray-100">üë©‚Äçüéì</button>
                        <button type="button" onclick="selectEmoji('üßë‚Äçüéì')" class="emoji-btn text-3xl p-2 border rounded hover:bg-gray-100">üßë‚Äçüéì</button>
                        <button type="button" onclick="selectEmoji('üë®‚Äçüíº')" class="emoji-btn text-3xl p-2 border rounded hover:bg-gray-100">üë®‚Äçüíº</button>
                        <button type="button" onclick="selectEmoji('üë©‚Äçüíº')" class="emoji-btn text-3xl p-2 border rounded hover:bg-gray-100">üë©‚Äçüíº</button>
                        <button type="button" onclick="selectEmoji('üßë‚Äçüíº')" class="emoji-btn text-3xl p-2 border rounded hover:bg-gray-100">üßë‚Äçüíº</button>
                        <button type="button" onclick="selectEmoji('üë®')" class="emoji-btn text-3xl p-2 border rounded hover:bg-gray-100">üë®</button>
                        <button type="button" onclick="selectEmoji('üë©')" class="emoji-btn text-3xl p-2 border rounded hover:bg-gray-100">üë©</button>
                    </div>
                </div>
                
                <!-- File Upload -->
                <div id="fileUpload" class="photo-option-content hidden">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Upload Foto</label>
                    <input type="file" id="photoFile" accept="image/*" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                    <p class="text-xs text-gray-500 mt-1">Format: JPG, PNG, GIF (Max: 2MB)</p>
                </div>
                
                <!-- Camera Capture -->
                <div id="cameraCapture" class="photo-option-content hidden">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Ambil Foto</label>
                    <div class="text-center">
                        <div id="cameraPreviewPhoto" class="w-48 h-36 bg-gray-200 rounded-lg flex items-center justify-center mx-auto mb-4">
                            <i class="fas fa-camera text-4xl text-gray-400"></i>
                        </div>
                        <button type="button" onclick="startPhotoCamera()" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 mr-2">
                            <i class="fas fa-video mr-2"></i>Buka Kamera
                        </button>
                        <button type="button" onclick="captureStudentPhoto()" class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700">
                            <i class="fas fa-camera mr-2"></i>Ambil Foto
                        </button>
                    </div>
                </div>
                
                <div class="flex space-x-4">
                    <button type="button" onclick="hideModal('editPhotoModal')" class="flex-1 bg-gray-300 text-gray-700 py-2 rounded-lg hover:bg-gray-400 transition-all">
                        Batal
                    </button>
                    <button type="submit" class="flex-1 btn-primary text-white py-2 rounded-lg hover:shadow-lg transition-all">
                        Simpan Foto
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Manage Account Modal -->
    <div id="manageAccountModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
        <div class="bg-white rounded-lg card-shadow p-6 w-full max-w-md">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-semibold text-gray-800">Kelola Akun Siswa</h3>
                <button onclick="hideModal('manageAccountModal')" class="text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div id="studentAccountInfo" class="mb-4">
                <!-- Student account info will be populated here -->
            </div>
            <form id="manageAccountForm" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Username</label>
                    <input type="text" id="editUsername" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" required>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Password Baru</label>
                    <div class="relative">
                        <input type="password" id="editPassword" class="w-full px-4 py-2 pr-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" placeholder="Kosongkan jika tidak ingin mengubah">
                        <button type="button" onclick="togglePasswordVisibility('editPassword')" class="absolute inset-y-0 right-0 pr-3 flex items-center">
                            <i id="editPassword-icon" class="fas fa-eye text-gray-400 hover:text-gray-600"></i>
                        </button>
                    </div>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Konfirmasi Password</label>
                    <div class="relative">
                        <input type="password" id="editConfirmPassword" class="w-full px-4 py-2 pr-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" placeholder="Kosongkan jika tidak ingin mengubah">
                        <button type="button" onclick="togglePasswordVisibility('editConfirmPassword')" class="absolute inset-y-0 right-0 pr-3 flex items-center">
                            <i id="editConfirmPassword-icon" class="fas fa-eye text-gray-400 hover:text-gray-600"></i>
                        </button>
                    </div>
                </div>
                <div class="flex space-x-4">
                    <button type="button" onclick="hideModal('manageAccountModal')" class="flex-1 bg-gray-300 text-gray-700 py-2 rounded-lg hover:bg-gray-400 transition-all">
                        Batal
                    </button>
                    <button type="submit" class="flex-1 btn-primary text-white py-2 rounded-lg hover:shadow-lg transition-all">
                        Simpan Perubahan
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Journal Modal -->
    <div id="addJournalModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
        <div class="bg-white rounded-lg card-shadow p-6 w-full max-w-md">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-semibold text-gray-800">Tambah Jurnal Kegiatan</h3>
                <button onclick="hideModal('addJournalModal')" class="text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form id="addJournalForm" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Tanggal</label>
                    <input type="date" id="journalDate" onchange="handleJournalDateChange()" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" required>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Kegiatan</label>
                    <input type="text" id="journalActivity" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" placeholder="Contoh: Latihan PBB, Upacara Bendera" required>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Materi</label>
                    <textarea id="journalMaterial" rows="3" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" placeholder="Deskripsi materi yang diajarkan" required></textarea>
                </div>
                <!-- Attendance Data from Selected Date -->
                <div id="attendanceDataSection" class="bg-gray-50 rounded-lg p-4 mb-4 hidden">
                    <h4 class="font-medium text-gray-800 mb-3">Data Kehadiran Tanggal Dipilih:</h4>
                    <div class="grid grid-cols-4 gap-4 text-center">
                        <div>
                            <div class="text-lg font-bold text-green-600" id="attendanceHadir">0</div>
                            <div class="text-xs text-gray-500">Hadir</div>
                        </div>
                        <div>
                            <div class="text-lg font-bold text-yellow-600" id="attendanceIzin">0</div>
                            <div class="text-xs text-gray-500">Izin</div>
                        </div>
                        <div>
                            <div class="text-lg font-bold text-blue-600" id="attendanceSakit">0</div>
                            <div class="text-xs text-gray-500">Sakit</div>
                        </div>
                        <div>
                            <div class="text-lg font-bold text-red-600" id="attendanceAlpha">0</div>
                            <div class="text-xs text-gray-500">Alpha</div>
                        </div>
                    </div>
                    <p class="text-xs text-gray-600 mt-2">Data ini akan otomatis digunakan untuk jurnal</p>
                </div>
                
                <!-- Hidden inputs for attendance data -->
                <input type="hidden" id="journalHadir">
                <input type="hidden" id="journalIzin">
                <input type="hidden" id="journalSakit">
                <input type="hidden" id="journalAlpha">
                <div class="flex space-x-4">
                    <button type="button" onclick="hideModal('addJournalModal')" class="flex-1 bg-gray-300 text-gray-700 py-2 rounded-lg hover:bg-gray-400 transition-all">
                        Batal
                    </button>
                    <button type="submit" class="flex-1 btn-primary text-white py-2 rounded-lg hover:shadow-lg transition-all">
                        Simpan Jurnal
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Student Detail Modal -->
    <div id="studentDetailModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
        <div class="bg-white rounded-lg card-shadow p-6 w-full max-w-4xl max-h-[90vh] overflow-y-auto">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-semibold text-gray-800">Detail Siswa</h3>
                <button onclick="hideModal('studentDetailModal')" class="text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div id="studentDetailContent">
                <!-- Student detail content will be populated here -->
            </div>
        </div>
    </div>

    <!-- Edit Coach Login Modal -->
    <div id="editCoachLoginModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
        <div class="bg-white rounded-lg card-shadow p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-semibold text-gray-800">Kelola Info Login</h3>
                <button onclick="hideModal('editCoachLoginModal')" class="text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <!-- Account Management Tabs -->
            <div class="mb-6">
                <div class="flex space-x-4">
                    <button onclick="showAccountTab('pelatih')" class="account-tab-btn bg-blue-600 text-white px-4 py-2 rounded-lg">
                        <i class="fas fa-user-tie mr-2"></i>Pelatih
                    </button>
                    <button onclick="showAccountTab('admin')" class="account-tab-btn bg-gray-300 text-gray-700 px-4 py-2 rounded-lg">
                        <i class="fas fa-user-shield mr-2"></i>Admin
                    </button>
                </div>
            </div>

            <!-- Pelatih Account Tab -->
            <div id="pelatihAccountTab" class="account-tab-content">
                <!-- Current Coach Login Info -->
                <div class="bg-blue-50 rounded-lg p-4 mb-4">
                    <h4 class="font-medium text-gray-800 mb-2">Info Login Pelatih Saat Ini:</h4>
                    <div class="space-y-1 text-sm">
                        <div><span class="text-gray-600">Username:</span> <span class="font-medium" id="currentCoachUsername">Munfasa</span></div>
                        <div><span class="text-gray-600">Password:</span> <span class="font-medium">‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢</span></div>
                    </div>
                </div>
                
                <form id="editCoachLoginForm" class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Username Baru</label>
                        <input type="text" id="newCoachUsername" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" required>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Password Baru</label>
                        <div class="relative">
                            <input type="password" id="newCoachPassword" class="w-full px-4 py-2 pr-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" required>
                            <button type="button" onclick="togglePasswordVisibility('newCoachPassword')" class="absolute inset-y-0 right-0 pr-3 flex items-center">
                                <i id="newCoachPassword-icon" class="fas fa-eye text-gray-400 hover:text-gray-600"></i>
                            </button>
                        </div>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Konfirmasi Password Baru</label>
                        <div class="relative">
                            <input type="password" id="confirmCoachPassword" class="w-full px-4 py-2 pr-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" required>
                            <button type="button" onclick="togglePasswordVisibility('confirmCoachPassword')" class="absolute inset-y-0 right-0 pr-3 flex items-center">
                                <i id="confirmCoachPassword-icon" class="fas fa-eye text-gray-400 hover:text-gray-600"></i>
                            </button>
                        </div>
                    </div>
                    <button type="submit" class="w-full btn-primary text-white py-2 rounded-lg hover:shadow-lg transition-all">
                        <i class="fas fa-save mr-2"></i>Simpan Perubahan Pelatih
                    </button>
                </form>
            </div>

            <!-- Admin Account Tab -->
            <div id="adminAccountTab" class="account-tab-content hidden">
                <!-- Current Admin Accounts List -->
                <div class="bg-green-50 rounded-lg p-4 mb-4">
                    <h4 class="font-medium text-gray-800 mb-3">Daftar Akun Admin:</h4>
                    <div id="adminAccountsList" class="space-y-2">
                        <!-- Admin accounts will be populated here -->
                    </div>
                </div>

                <!-- Add New Admin Form -->
                <div class="border-t pt-4">
                    <h4 class="font-medium text-gray-800 mb-4">Tambah Akun Admin Baru:</h4>
                    <form id="addAdminForm" class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Username Admin</label>
                            <input type="text" id="newAdminUsername" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" required>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Password Admin</label>
                            <div class="relative">
                                <input type="password" id="newAdminPassword" class="w-full px-4 py-2 pr-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" required>
                                <button type="button" onclick="togglePasswordVisibility('newAdminPassword')" class="absolute inset-y-0 right-0 pr-3 flex items-center">
                                    <i id="newAdminPassword-icon" class="fas fa-eye text-gray-400 hover:text-gray-600"></i>
                                </button>
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Konfirmasi Password</label>
                            <div class="relative">
                                <input type="password" id="confirmAdminPassword" class="w-full px-4 py-2 pr-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" required>
                                <button type="button" onclick="togglePasswordVisibility('confirmAdminPassword')" class="absolute inset-y-0 right-0 pr-3 flex items-center">
                                    <i id="confirmAdminPassword-icon" class="fas fa-eye text-gray-400 hover:text-gray-600"></i>
                                </button>
                            </div>
                        </div>
                        <button type="submit" class="w-full bg-green-600 text-white py-2 rounded-lg hover:bg-green-700 transition-all">
                            <i class="fas fa-plus mr-2"></i>Tambah Admin
                        </button>
                    </form>
                </div>
            </div>

            <!-- Close Button -->
            <div class="flex justify-end mt-6 pt-4 border-t">
                <button onclick="hideModal('editCoachLoginModal')" class="bg-gray-300 text-gray-700 px-6 py-2 rounded-lg hover:bg-gray-400 transition-all">
                    Tutup
                </button>
            </div>
        </div>
    </div>

    <!-- Camera Modal for Attendance -->
    <div id="cameraModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
        <div class="bg-white rounded-lg card-shadow p-6 w-full max-w-md">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-semibold text-gray-800">Foto Kehadiran</h3>
                <button onclick="hideModal('cameraModal')" class="text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="text-center">
                <div id="cameraPreview" class="w-64 h-48 bg-gray-200 rounded-lg flex items-center justify-center mx-auto mb-4">
                    <i class="fas fa-camera text-4xl text-gray-400"></i>
                </div>
                <div id="studentPhotoInfo" class="mb-4">
                    <!-- Student info will be shown here -->
                </div>
                <div class="flex space-x-4">
                    <button onclick="startCamera()" class="flex-1 bg-blue-600 text-white py-2 rounded-lg hover:bg-blue-700 transition-all">
                        <i class="fas fa-video mr-2"></i>Buka Kamera
                    </button>
                    <button onclick="capturePhoto()" class="flex-1 btn-primary text-white py-2 rounded-lg hover:shadow-lg transition-all">
                        <i class="fas fa-camera mr-2"></i>Ambil Foto
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let currentUser = null;
        let coachCredentials = {
            username: 'Munfasa',
            password: 'Munfasa05'
        };
        let adminAccounts = [
            { id: 1, username: 'admin1', password: 'admin123', createdAt: '2024-01-01' },
            { id: 2, username: 'admin_paskibra', password: 'paskibra2024', createdAt: '2024-01-05' }
        ];
        let students = [];
        
        let assignments = [];

        let additionalStudentFields = [];
        let attendanceOverviewChart;
        let attendanceData = {};
        let dailyAttendanceRecords = {}; // Store attendance by date
        let selectedStudentId = null;
        let selectedEmoji = null;
        let selectedAssignmentId = null;
        
        let studentActivities = [];
        
        let adminActivities = [];
        
        let materials = [];

        let journalEntries = [];

        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            updateClock();
            setInterval(updateClock, 1000);
            
            // Set default dates for attendance filter (only if elements exist)
            const startDateEl = document.getElementById('startDate');
            const endDateEl = document.getElementById('endDate');
            if (startDateEl && endDateEl) {
                const today = new Date();
                const firstDay = new Date(today.getFullYear(), today.getMonth(), 1);
                startDateEl.valueAsDate = firstDay;
                endDateEl.valueAsDate = today;
            }
            
            // Initialize data
            populateStudentsTable();
            populateManualAttendance();
            populateAssignments();
            populateStudentAssignments();
            populateIndividualReports();
            populateMaterials();
            populateCoachMaterials();
            populateAssignmentSelection();
            populateActivities();
            populateJournalEntries();
            populateAdminJournalEntries();
            populatePelatihJournalEntries();
            populateAdminAccountsList();
            populatePelatihAdminAccountsList();
            
            // Set default dates for journal filter
            const today = new Date();
            const firstDay = new Date(today.getFullYear(), today.getMonth(), 1);
            document.getElementById('journalStartDate').valueAsDate = firstDay;
            document.getElementById('journalEndDate').valueAsDate = today;
            
            // Set default dates for admin journal filter
            document.getElementById('adminJournalStartDate').valueAsDate = firstDay;
            document.getElementById('adminJournalEndDate').valueAsDate = today;
            
            // Set default dates for pelatih journal filter
            document.getElementById('pelatihJournalStartDate').valueAsDate = firstDay;
            document.getElementById('pelatihJournalEndDate').valueAsDate = today;
        });

        // Journal functions
        function populateJournalEntries() {
            const container = document.getElementById('journalEntriesList');
            container.innerHTML = '';
            
            journalEntries.forEach(entry => {
                const total = entry.hadir + entry.izin + entry.sakit + entry.alpha;
                const div = document.createElement('div');
                div.className = 'bg-white rounded-lg card-shadow p-4';
                div.innerHTML = `
                    <div class="flex justify-between items-start mb-3">
                        <div>
                            <h3 class="font-semibold text-gray-800">${entry.activity}</h3>
                            <p class="text-sm text-gray-500">${new Date(entry.date).toLocaleDateString('id-ID')}</p>
                            <p class="text-xs text-gray-400">Dibuat oleh: Admin</p>
                        </div>
                        <div class="flex space-x-2">
                            <button onclick="editJournalEntry(${entry.id})" class="text-blue-600 hover:text-blue-800" title="Edit">
                                <i class="fas fa-edit"></i>
                            </button>
                            <span class="text-xs text-gray-500 px-2 py-1 bg-gray-100 rounded">Monitoring</span>
                        </div>
                    </div>
                    
                    <p class="text-gray-600 text-sm mb-3">${entry.material}</p>
                    
                    <div class="flex justify-between items-center text-sm">
                        <div class="flex space-x-4">
                            <span class="text-green-600">Hadir: ${entry.hadir}</span>
                            <span class="text-yellow-600">Izin: ${entry.izin}</span>
                            <span class="text-blue-600">Sakit: ${entry.sakit}</span>
                            <span class="text-red-600">Alpha: ${entry.alpha}</span>
                        </div>
                        <span class="text-gray-500">Total: ${total}</span>
                    </div>
                `;
                container.appendChild(div);
            });
        }

        function filterJournalData() {
            const startDate = document.getElementById('journalStartDate').value;
            const endDate = document.getElementById('journalEndDate').value;
            
            if (startDate && endDate) {
                alert(`Filter jurnal dari ${new Date(startDate).toLocaleDateString('id-ID')} sampai ${new Date(endDate).toLocaleDateString('id-ID')}`);
                // In real app, this would filter the journal entries
            } else {
                alert('Pilih rentang tanggal terlebih dahulu!');
            }
        }

        function filterPelatihJournalData() {
            const startDate = document.getElementById('pelatihJournalStartDate').value;
            const endDate = document.getElementById('pelatihJournalEndDate').value;
            
            if (startDate && endDate) {
                alert(`Filter jurnal dari ${new Date(startDate).toLocaleDateString('id-ID')} sampai ${new Date(endDate).toLocaleDateString('id-ID')}`);
                populatePelatihJournalEntries();
            } else {
                alert('Pilih rentang tanggal terlebih dahulu!');
            }
        }

        function populatePelatihJournalEntries() {
            const container = document.getElementById('pelatihJournalEntriesList');
            container.innerHTML = '';
            
            journalEntries.forEach(entry => {
                const total = entry.hadir + entry.izin + entry.sakit + entry.alpha;
                const div = document.createElement('div');
                div.className = 'bg-white rounded-lg card-shadow p-4';
                div.innerHTML = `
                    <div class="flex justify-between items-start mb-3">
                        <div>
                            <h3 class="font-semibold text-gray-800">${entry.activity}</h3>
                            <p class="text-sm text-gray-500">${new Date(entry.date).toLocaleDateString('id-ID')}</p>
                            <p class="text-xs text-gray-400">Dibuat oleh: Admin</p>
                        </div>
                        <div class="flex space-x-2">
                            <button onclick="editJournalEntry(${entry.id})" class="text-blue-600 hover:text-blue-800" title="Edit">
                                <i class="fas fa-edit"></i>
                            </button>
                            <span class="text-xs text-gray-500 px-2 py-1 bg-gray-100 rounded">Monitoring</span>
                        </div>
                    </div>
                    
                    <p class="text-gray-600 text-sm mb-3">${entry.material}</p>
                    
                    <div class="flex justify-between items-center text-sm">
                        <div class="flex space-x-4">
                            <span class="text-green-600">Hadir: ${entry.hadir}</span>
                            <span class="text-yellow-600">Izin: ${entry.izin}</span>
                            <span class="text-blue-600">Sakit: ${entry.sakit}</span>
                            <span class="text-red-600">Alpha: ${entry.alpha}</span>
                        </div>
                        <span class="text-gray-500">Total: ${total}</span>
                    </div>
                `;
                container.appendChild(div);
            });
        }

        function filterAdminJournalData() {
            const startDate = document.getElementById('adminJournalStartDate').value;
            const endDate = document.getElementById('adminJournalEndDate').value;
            
            if (startDate && endDate) {
                alert(`Filter jurnal dari ${new Date(startDate).toLocaleDateString('id-ID')} sampai ${new Date(endDate).toLocaleDateString('id-ID')}`);
                populateAdminJournalEntries();
            } else {
                alert('Pilih rentang tanggal terlebih dahulu!');
            }
        }

        function populateAdminJournalEntries() {
            const container = document.getElementById('adminJournalEntriesList');
            container.innerHTML = '';
            
            journalEntries.forEach(entry => {
                const total = entry.hadir + entry.izin + entry.sakit + entry.alpha;
                const div = document.createElement('div');
                div.className = 'bg-white rounded-lg card-shadow p-4';
                div.innerHTML = `
                    <div class="flex justify-between items-start mb-3">
                        <div>
                            <h3 class="font-semibold text-gray-800">${entry.activity}</h3>
                            <p class="text-sm text-gray-500">${new Date(entry.date).toLocaleDateString('id-ID')}</p>
                            <p class="text-xs text-gray-400">Dibuat oleh: Admin</p>
                        </div>
                        <div class="flex space-x-2">
                            <button onclick="editJournalEntry(${entry.id})" class="text-blue-600 hover:text-blue-800" title="Edit">
                                <i class="fas fa-edit"></i>
                            </button>
                            <span class="text-xs text-gray-500 px-2 py-1 bg-gray-100 rounded">Monitoring</span>
                        </div>
                    </div>
                    
                    <p class="text-gray-600 text-sm mb-3">${entry.material}</p>
                    
                    <div class="flex justify-between items-center text-sm">
                        <div class="flex space-x-4">
                            <span class="text-green-600">Hadir: ${entry.hadir}</span>
                            <span class="text-yellow-600">Izin: ${entry.izin}</span>
                            <span class="text-blue-600">Sakit: ${entry.sakit}</span>
                            <span class="text-red-600">Alpha: ${entry.alpha}</span>
                        </div>
                        <span class="text-gray-500">Total: ${total}</span>
                    </div>
                `;
                container.appendChild(div);
            });
        }

        function printJournalReport() {
            alert('Laporan jurnal kegiatan berhasil dicetak!');
        }

        function editJournalEntry(id) {
            const entry = journalEntries.find(e => e.id === id);
            if (entry) {
                // Populate form with entry data
                document.getElementById('journalDate').value = entry.date;
                document.getElementById('journalActivity').value = entry.activity;
                document.getElementById('journalMaterial').value = entry.material;
                document.getElementById('journalHadir').value = entry.hadir;
                document.getElementById('journalIzin').value = entry.izin;
                document.getElementById('journalSakit').value = entry.sakit;
                document.getElementById('journalAlpha').value = entry.alpha;
                
                // Store ID for editing
                window.editingJournalId = id;
                showModal('addJournalModal');
            }
        }

        function deleteJournalEntry(id) {
            if (confirm('Apakah Anda yakin ingin menghapus jurnal ini?')) {
                const index = journalEntries.findIndex(e => e.id === id);
                if (index > -1) {
                    journalEntries.splice(index, 1);
                    populateJournalEntries();
                    alert('Jurnal berhasil dihapus!');
                }
            }
        }

        // Tugas Materi tab functions
        function showTugasMateriTab(tab) {
            // Update tab buttons
            document.querySelectorAll('.tugas-materi-tab-btn').forEach(btn => {
                btn.classList.remove('bg-blue-600', 'text-white');
                btn.classList.add('bg-gray-300', 'text-gray-700');
            });
            event.target.classList.remove('bg-gray-300', 'text-gray-700');
            event.target.classList.add('bg-blue-600', 'text-white');
            
            // Show/hide content
            document.querySelectorAll('.tugas-materi-content').forEach(content => {
                content.classList.add('hidden');
            });
            
            if (tab === 'tugas') {
                document.getElementById('tugasTab').classList.remove('hidden');
            } else if (tab === 'materi') {
                document.getElementById('materiTab').classList.remove('hidden');
            } else if (tab === 'laporan') {
                document.getElementById('laporanTab').classList.remove('hidden');
            }
        }

        // Student detail function
        function showStudentDetail(studentId) {
            const student = students.find(s => s.id === studentId);
            if (!student) return;

            // Calculate attendance stats (simulated)
            const attendanceStats = {
                hadir: Math.floor(Math.random() * 20) + 15,
                izin: Math.floor(Math.random() * 3) + 1,
                sakit: Math.floor(Math.random() * 2),
                alpha: Math.floor(Math.random() * 1)
            };
            const totalAttendance = attendanceStats.hadir + attendanceStats.izin + attendanceStats.sakit + attendanceStats.alpha;
            const attendancePercentage = Math.round((attendanceStats.hadir / totalAttendance) * 100);

            // Calculate assignment progress (simulated)
            const completedAssignments = Math.floor(Math.random() * assignments.length);
            const assignmentPercentage = Math.round((completedAssignments / assignments.length) * 100);

            const content = document.getElementById('studentDetailContent');
            content.innerHTML = `
                <!-- Student Header -->
                <div class="flex items-center mb-6 p-6 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg">
                    <div class="text-6xl mr-6">${student.photo}</div>
                    <div>
                        <h2 class="text-2xl font-bold text-gray-800">${student.name}</h2>
                        <p class="text-gray-600">${student.class} ‚Ä¢ ID: 2024${student.id.toString().padStart(3, '0')}</p>
                        <p class="text-sm text-gray-500">${student.birthPlace}, ${new Date(student.birthDate).toLocaleDateString('id-ID')}</p>
                    </div>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <!-- Personal Information -->
                    <div class="bg-white rounded-lg border p-6">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">Informasi Pribadi</h3>
                        <div class="space-y-3">
                            <div class="flex justify-between">
                                <span class="text-gray-600">Nama Lengkap:</span>
                                <span class="font-medium">${student.name}</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Kelas:</span>
                                <span class="font-medium">${student.class}</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">TTL:</span>
                                <span class="font-medium">${student.birthPlace}, ${new Date(student.birthDate).toLocaleDateString('id-ID')}</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Nama Orangtua:</span>
                                <span class="font-medium">${student.parentName}</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Username:</span>
                                <span class="font-medium">${student.username}</span>
                            </div>
                        </div>
                    </div>

                    <!-- Attendance Statistics -->
                    <div class="bg-white rounded-lg border p-6">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">Statistik Kehadiran</h3>
                        <div class="mb-4">
                            <div class="flex justify-between items-center mb-2">
                                <span class="text-sm text-gray-600">Tingkat Kehadiran</span>
                                <span class="text-sm font-medium">${attendancePercentage}%</span>
                            </div>
                            <div class="w-full bg-gray-200 rounded-full h-2">
                                <div class="bg-green-600 h-2 rounded-full" style="width: ${attendancePercentage}%"></div>
                            </div>
                        </div>
                        <div class="grid grid-cols-2 gap-4">
                            <div class="text-center">
                                <div class="text-2xl font-bold text-green-600">${attendanceStats.hadir}</div>
                                <div class="text-xs text-gray-500">Hadir</div>
                            </div>
                            <div class="text-center">
                                <div class="text-2xl font-bold text-yellow-600">${attendanceStats.izin}</div>
                                <div class="text-xs text-gray-500">Izin</div>
                            </div>
                            <div class="text-center">
                                <div class="text-2xl font-bold text-blue-600">${attendanceStats.sakit}</div>
                                <div class="text-xs text-gray-500">Sakit</div>
                            </div>
                            <div class="text-center">
                                <div class="text-2xl font-bold text-red-600">${attendanceStats.alpha}</div>
                                <div class="text-xs text-gray-500">Alpha</div>
                            </div>
                        </div>
                    </div>

                    <!-- Assignment Progress -->
                    <div class="bg-white rounded-lg border p-6">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">Progres Tugas</h3>
                        <div class="mb-4">
                            <div class="flex justify-between items-center mb-2">
                                <span class="text-sm text-gray-600">Tugas Diselesaikan</span>
                                <span class="text-sm font-medium">${completedAssignments}/${assignments.length}</span>
                            </div>
                            <div class="w-full bg-gray-200 rounded-full h-2">
                                <div class="bg-blue-600 h-2 rounded-full" style="width: ${assignmentPercentage}%"></div>
                            </div>
                        </div>
                        <div class="space-y-2">
                            ${assignments.map(assignment => {
                                const isCompleted = Math.random() > 0.3;
                                return `
                                    <div class="flex justify-between items-center text-sm">
                                        <span class="text-gray-600">${assignment.title}</span>
                                        <span class="${isCompleted ? 'text-green-600' : 'text-red-600'}">
                                            <i class="fas fa-${isCompleted ? 'check-circle' : 'times-circle'}"></i>
                                            ${isCompleted ? 'Selesai' : 'Belum'}
                                        </span>
                                    </div>
                                `;
                            }).join('')}
                        </div>
                    </div>

                    <!-- Recent Activity -->
                    <div class="bg-white rounded-lg border p-6">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">Aktivitas Terbaru</h3>
                        <div class="space-y-3">
                            ${studentActivities.filter(activity => activity.student === student.name).slice(0, 5).map(activity => `
                                <div class="flex items-center text-sm">
                                    <div class="w-2 h-2 bg-blue-600 rounded-full mr-3"></div>
                                    <div class="flex-1">
                                        <div class="text-gray-800">${activity.action}</div>
                                        <div class="text-gray-500 text-xs">${new Date(activity.time).toLocaleString('id-ID')}</div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                </div>

                <!-- Action Buttons -->
                <div class="flex justify-end space-x-4 mt-6 pt-6 border-t border-gray-200">
                    <button onclick="editStudent(${student.id}); hideModal('studentDetailModal')" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700">
                        <i class="fas fa-edit mr-2"></i>Edit Data
                    </button>
                    <button onclick="printStudentReport(${student.id})" class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700">
                        <i class="fas fa-print mr-2"></i>Cetak Laporan
                    </button>
                </div>
            `;
            
            showModal('studentDetailModal');
        }

        function printStudentReport(studentId) {
            const student = students.find(s => s.id === studentId);
            alert(`Laporan lengkap ${student.name} berhasil dicetak!`);
        }

        // Journal date change handler
        function handleJournalDateChange() {
            const selectedDate = document.getElementById('journalDate').value;
            const attendanceSection = document.getElementById('attendanceDataSection');
            
            if (selectedDate && dailyAttendanceRecords[selectedDate]) {
                const record = dailyAttendanceRecords[selectedDate];
                const counts = record.statusCounts;
                
                // Show attendance data
                document.getElementById('attendanceHadir').textContent = counts.hadir;
                document.getElementById('attendanceIzin').textContent = counts.izin;
                document.getElementById('attendanceSakit').textContent = counts.sakit;
                document.getElementById('attendanceAlpha').textContent = counts.alpha;
                
                // Set hidden inputs
                document.getElementById('journalHadir').value = counts.hadir;
                document.getElementById('journalIzin').value = counts.izin;
                document.getElementById('journalSakit').value = counts.sakit;
                document.getElementById('journalAlpha').value = counts.alpha;
                
                attendanceSection.classList.remove('hidden');
            } else {
                attendanceSection.classList.add('hidden');
                // Clear hidden inputs
                document.getElementById('journalHadir').value = '';
                document.getElementById('journalIzin').value = '';
                document.getElementById('journalSakit').value = '';
                document.getElementById('journalAlpha').value = '';
                
                if (selectedDate) {
                    alert('Tidak ada data absensi untuk tanggal ini. Silakan input absensi terlebih dahulu.');
                }
            }
        }

        // Add journal form handler
        document.getElementById('addJournalForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const selectedDate = document.getElementById('journalDate').value;
            
            // Check if attendance data exists for selected date
            if (!dailyAttendanceRecords[selectedDate]) {
                alert('Tidak ada data absensi untuk tanggal ini. Silakan input absensi terlebih dahulu.');
                return;
            }
            
            const journalData = {
                date: selectedDate,
                activity: document.getElementById('journalActivity').value,
                material: document.getElementById('journalMaterial').value,
                hadir: parseInt(document.getElementById('journalHadir').value) || 0,
                izin: parseInt(document.getElementById('journalIzin').value) || 0,
                sakit: parseInt(document.getElementById('journalSakit').value) || 0,
                alpha: parseInt(document.getElementById('journalAlpha').value) || 0
            };
            
            if (window.editingJournalId) {
                // Edit existing entry
                const entry = journalEntries.find(e => e.id === window.editingJournalId);
                Object.assign(entry, journalData);
                window.editingJournalId = null;
                alert('Jurnal berhasil diperbarui!');
            } else {
                // Add new entry
                const newEntry = {
                    id: journalEntries.length + 1,
                    ...journalData
                };
                journalEntries.push(newEntry);
                alert('Jurnal berhasil ditambahkan!');
            }
            
            populateJournalEntries();
            populateAdminJournalEntries();
            hideModal('addJournalModal');
            this.reset();
            
            // Reset attendance section
            document.getElementById('attendanceDataSection').classList.add('hidden');
        });

        // Clock functions
        function updateClock() {
            const now = new Date();
            const timeString = now.toLocaleTimeString('id-ID', { 
                hour12: false,
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit'
            });
            const dateString = now.toLocaleDateString('id-ID', {
                weekday: 'long',
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
            
            document.getElementById('digitalClock').textContent = timeString;
            document.getElementById('currentDate').textContent = dateString;
            
            // Update admin dashboard clock
            const adminTimeElement = document.getElementById('adminCurrentTime');
            const adminDateElement = document.getElementById('adminCurrentDate');
            if (adminTimeElement && adminDateElement) {
                adminTimeElement.textContent = timeString;
                adminDateElement.textContent = dateString;
            }
        }

        // Login function
        document.getElementById('loginForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const role = document.getElementById('userRole').value;
            const username = document.getElementById('username').value.trim();
            const password = document.getElementById('password').value.trim();
            
            // Hide any previous error messages
            document.getElementById('loginError').classList.add('hidden');
            
            if (!username || !password) {
                showLoginError('Masukkan username dan password!');
                return;
            }
            
            // Validate credentials based on role
            let loginSuccess = false;
            
            if (role === 'pelatih') {
                // Pelatih must use exact credentials
                if (username === coachCredentials.username && password === coachCredentials.password) {
                    loginSuccess = true;
                } else {
                    showLoginError();
                    return;
                }
            } else if (role === 'admin') {
                // Admin must use registered admin credentials
                const adminAccount = adminAccounts.find(admin => admin.username === username && admin.password === password);
                if (adminAccount) {
                    loginSuccess = true;
                } else {
                    showLoginError();
                    return;
                }
            } else if (role === 'siswa') {
                // Siswa can use any non-empty credentials for demo
                loginSuccess = true;
            }
            
            if (loginSuccess) {
                currentUser = { role, username };
                document.getElementById('landingPage').classList.add('hidden');
                
                if (role === 'admin') {
                    document.getElementById('adminDashboard').classList.remove('hidden');
                    // Use setTimeout to ensure DOM is ready
                    setTimeout(() => {
                        showAdminSection('absensiManual');
                    }, 50);
                } else if (role === 'pelatih') {
                    document.getElementById('pelatihDashboard').classList.remove('hidden');
                    setTimeout(() => {
                        showPelatihSection('dataSiswa');
                        initAttendanceOverviewChart();
                    }, 50);
                } else if (role === 'siswa') {
                    document.getElementById('studentDashboard').classList.remove('hidden');
                    setTimeout(() => {
                        loadStudentProfile(username);
                        showStudentSection('profil');
                        initAttendanceChart();
                    }, 50);
                }
            }
        });

        // Show login error function
        function showLoginError(customMessage = null) {
            const errorDiv = document.getElementById('loginError');
            const errorText = errorDiv.querySelector('p');
            
            if (customMessage) {
                errorText.textContent = customMessage;
            } else {
                errorText.textContent = 'Password salah! Silakan periksa kembali username dan password Anda.';
            }
            
            errorDiv.classList.remove('hidden');
            
            // Add shake animation
            errorDiv.style.animation = 'shake 0.5s ease-in-out';
            setTimeout(() => {
                errorDiv.style.animation = '';
            }, 500);
            
            // Auto hide after 5 seconds
            setTimeout(() => {
                errorDiv.classList.add('hidden');
            }, 5000);
        }

        // Logout function
        function logout() {
            currentUser = null;
            document.getElementById('adminDashboard').classList.add('hidden');
            document.getElementById('pelatihDashboard').classList.add('hidden');
            document.getElementById('studentDashboard').classList.add('hidden');
            document.getElementById('landingPage').classList.remove('hidden');
            document.getElementById('loginForm').reset();
        }

        // Admin navigation
        function showAdminSection(sectionId) {
            // Hide all sections
            document.querySelectorAll('.admin-section').forEach(section => {
                section.classList.add('hidden');
            });
            
            // Show selected section
            const targetSection = document.getElementById(sectionId);
            if (targetSection) {
                targetSection.classList.remove('hidden');
            }
            
            // Update navigation - only if event exists (clicked by user)
            if (typeof event !== 'undefined' && event.target) {
                document.querySelectorAll('.admin-nav-btn').forEach(btn => {
                    btn.classList.remove('border-blue-500', 'text-blue-600');
                    btn.classList.add('border-transparent', 'text-gray-600');
                });
                event.target.classList.remove('border-transparent', 'text-gray-600');
                event.target.classList.add('border-blue-500', 'text-blue-600');
            } else {
                // Programmatic call - find and highlight the correct button
                document.querySelectorAll('.admin-nav-btn').forEach(btn => {
                    btn.classList.remove('border-blue-500', 'text-blue-600');
                    btn.classList.add('border-transparent', 'text-gray-600');
                    
                    // Check if this button corresponds to the section
                    if (btn.onclick && btn.onclick.toString().includes(sectionId)) {
                        btn.classList.remove('border-transparent', 'text-gray-600');
                        btn.classList.add('border-blue-500', 'text-blue-600');
                    }
                });
            }
        }

        // Pelatih navigation
        function showPelatihSection(sectionId) {
            // Hide all sections
            document.querySelectorAll('.pelatih-section').forEach(section => {
                section.classList.add('hidden');
            });
            
            // Show selected section
            const targetSection = document.getElementById(sectionId);
            if (targetSection) {
                targetSection.classList.remove('hidden');
            }
            
            // Update navigation - only if event exists (clicked by user)
            if (typeof event !== 'undefined' && event.target) {
                document.querySelectorAll('.pelatih-nav-btn').forEach(btn => {
                    btn.classList.remove('border-blue-500', 'text-blue-600');
                    btn.classList.add('border-transparent', 'text-gray-600');
                });
                event.target.classList.remove('border-transparent', 'text-gray-600');
                event.target.classList.add('border-blue-500', 'text-blue-600');
            } else {
                // Programmatic call - find and highlight the correct button
                document.querySelectorAll('.pelatih-nav-btn').forEach(btn => {
                    btn.classList.remove('border-blue-500', 'text-blue-600');
                    btn.classList.add('border-transparent', 'text-gray-600');
                    
                    // Check if this button corresponds to the section
                    if (btn.onclick && btn.onclick.toString().includes(sectionId)) {
                        btn.classList.remove('border-transparent', 'text-gray-600');
                        btn.classList.add('border-blue-500', 'text-blue-600');
                    }
                });
            }
        }

        // Student navigation
        function showStudentSection(sectionId) {
            // Hide all sections
            document.querySelectorAll('.student-section').forEach(section => {
                section.classList.add('hidden');
            });
            
            // Show selected section
            const targetSection = document.getElementById(sectionId);
            if (targetSection) {
                targetSection.classList.remove('hidden');
            }
            
            // Update navigation - only if event exists (clicked by user)
            if (typeof event !== 'undefined' && event.target) {
                document.querySelectorAll('.student-nav-btn').forEach(btn => {
                    btn.classList.remove('border-blue-500', 'text-blue-600');
                    btn.classList.add('border-transparent', 'text-gray-600');
                });
                event.target.classList.remove('border-transparent', 'text-gray-600');
                event.target.classList.add('border-blue-500', 'text-blue-600');
            } else {
                // Programmatic call - find and highlight the correct button
                document.querySelectorAll('.student-nav-btn').forEach(btn => {
                    btn.classList.remove('border-blue-500', 'text-blue-600');
                    btn.classList.add('border-transparent', 'text-gray-600');
                    
                    // Check if this button corresponds to the section
                    if (btn.onclick && btn.onclick.toString().includes(sectionId)) {
                        btn.classList.remove('border-transparent', 'text-gray-600');
                        btn.classList.add('border-blue-500', 'text-blue-600');
                    }
                });
            }
        }

        // Students management by class
        function populateStudentsTable() {
            populateClassStudents('7', 'class7StudentsBody');
            populateClassStudents('8', 'class8StudentsBody');
            populateClassStudents('9', 'class9StudentsBody');
        }

        function populateClassStudents(classNumber, tbodyId) {
            const tbody = document.getElementById(tbodyId);
            tbody.innerHTML = '';
            
            const classStudents = students.filter(student => student.class.startsWith(classNumber));
            
            classStudents.forEach(student => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="text-2xl">${student.photo}</div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <button onclick="showStudentDetail(${student.id})" class="text-sm font-medium text-blue-600 hover:text-blue-900 cursor-pointer">
                            ${student.name}
                        </button>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                        ${student.birthPlace}, ${new Date(student.birthDate).toLocaleDateString('id-ID')}
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                        ${student.class}
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                        <button onclick="editStudent(${student.id})" class="text-indigo-600 hover:text-indigo-900 mr-2" title="Edit Data">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button onclick="editStudentPhoto(${student.id})" class="text-blue-600 hover:text-blue-900 mr-2" title="Edit Foto">
                            <i class="fas fa-camera"></i>
                        </button>
                        <button onclick="manageStudentAccount(${student.id})" class="text-green-600 hover:text-green-900 mr-2" title="Kelola Akun">
                            <i class="fas fa-user-cog"></i>
                        </button>
                        <button onclick="deleteStudent(${student.id})" class="text-red-600 hover:text-red-900" title="Hapus">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        // Class tab functions
        function showClassTab(classNumber) {
            // Update tab buttons
            document.querySelectorAll('.class-tab-btn').forEach(btn => {
                btn.classList.remove('bg-green-600', 'bg-blue-600', 'bg-purple-600', 'text-white');
                btn.classList.add('bg-gray-300', 'text-gray-700');
            });
            
            // Highlight active tab
            const colors = { '7': 'bg-green-600', '8': 'bg-blue-600', '9': 'bg-purple-600' };
            event.target.classList.remove('bg-gray-300', 'text-gray-700');
            event.target.classList.add(colors[classNumber], 'text-white');
            
            // Show/hide sections
            document.querySelectorAll('.class-students-section').forEach(section => {
                section.classList.add('hidden');
            });
            document.getElementById(`class${classNumber}Students`).classList.remove('hidden');
        }

        // Photo option functions
        function showPhotoOption(option) {
            // Update option buttons
            document.querySelectorAll('.photo-option-btn').forEach(btn => {
                btn.classList.remove('bg-blue-600', 'text-white');
                btn.classList.add('bg-gray-300', 'text-gray-700');
            });
            event.target.classList.remove('bg-gray-300', 'text-gray-700');
            event.target.classList.add('bg-blue-600', 'text-white');
            
            // Show/hide content
            document.querySelectorAll('.photo-option-content').forEach(content => {
                content.classList.add('hidden');
            });
            
            if (option === 'emoji') {
                document.getElementById('emojiSelection').classList.remove('hidden');
            } else if (option === 'upload') {
                document.getElementById('fileUpload').classList.remove('hidden');
            } else if (option === 'camera') {
                document.getElementById('cameraCapture').classList.remove('hidden');
            }
        }

        // Photo camera functions
        function startPhotoCamera() {
            document.getElementById('cameraPreviewPhoto').innerHTML = `
                <div class="w-full h-full bg-blue-100 rounded-lg flex items-center justify-center">
                    <div class="text-center">
                        <i class="fas fa-video text-2xl text-blue-600 mb-2"></i>
                        <p class="text-xs text-blue-600">Kamera Aktif</p>
                    </div>
                </div>
            `;
        }

        function captureStudentPhoto() {
            document.getElementById('cameraPreviewPhoto').innerHTML = `
                <div class="w-full h-full bg-green-100 rounded-lg flex items-center justify-center">
                    <div class="text-center">
                        <i class="fas fa-check-circle text-2xl text-green-600 mb-2"></i>
                        <p class="text-xs text-green-600">Foto Tersimpan</p>
                    </div>
                </div>
            `;
            selectedEmoji = 'üì∑'; // Indicate photo was taken
        }

        // Print attendance report
        function printAttendanceReport() {
            const startDate = document.getElementById('startDate').value;
            const endDate = document.getElementById('endDate').value;
            
            if (startDate && endDate) {
                alert(`Mencetak laporan absensi dari ${new Date(startDate).toLocaleDateString('id-ID')} sampai ${new Date(endDate).toLocaleDateString('id-ID')}`);
                // In real app, this would generate and print the report
            } else {
                alert('Pilih rentang tanggal terlebih dahulu!');
            }
        }

        function updateStudentsTableHeader() {
            const header = document.getElementById('studentsTableHeader');
            let additionalHeadersHtml = '';
            additionalStudentFields.forEach(field => {
                additionalHeadersHtml += `
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">${field.name}</th>
                `;
            });
            
            header.innerHTML = `
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Foto</th>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Nama</th>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Kelas</th>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">TTL</th>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Nama Orangtua</th>
                ${additionalHeadersHtml}
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Aksi</th>
            `;
        }

        // Add student form
        document.getElementById('addStudentForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const newStudent = {
                id: students.length + 1,
                name: document.getElementById('studentName').value,
                class: document.getElementById('studentClass').value,
                birthPlace: document.getElementById('birthPlace').value,
                birthDate: document.getElementById('birthDate').value,
                parentName: document.getElementById('parentName').value,
                photo: 'üë®‚Äçüéì'
            };

            // Add additional fields
            additionalStudentFields.forEach(field => {
                const fieldElement = document.getElementById(field.id);
                if (fieldElement) {
                    newStudent[field.id] = fieldElement.value;
                }
            });
            
            students.push(newStudent);
            populateStudentsTable();
            populateManualAttendance();
            populateIndividualReports();
            hideModal('addStudentModal');
            this.reset();
            
            // Simulate save to Google Drive
            alert('Data siswa berhasil disimpan dan disinkronkan ke Google Drive!');
        });

        // Add field form
        document.getElementById('addFieldForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const fieldName = document.getElementById('fieldName').value;
            const fieldType = document.getElementById('fieldType').value;
            const fieldId = fieldName.toLowerCase().replace(/\s+/g, '_');

            const newField = {
                id: fieldId,
                name: fieldName,
                type: fieldType
            };

            additionalStudentFields.push(newField);
            updateStudentsTableHeader();
            updateAddStudentForm();
            populateStudentsTable();
            hideModal('addFieldModal');
            this.reset();

            alert(`Field "${fieldName}" berhasil ditambahkan!`);
        });

        // Add assignment form
        document.getElementById('addAssignmentForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const newAssignment = {
                id: assignments.length + 1,
                title: document.getElementById('newAssignmentTitle').value,
                description: document.getElementById('newAssignmentDescription').value,
                dueDate: document.getElementById('newAssignmentDeadline').value,
                submissions: []
            };

            assignments.push(newAssignment);
            populateAssignments();
            populateStudentAssignments();
            hideModal('addAssignmentModal');
            this.reset();

            alert('Tugas baru berhasil ditambahkan!');
        });

        function updateAddStudentForm() {
            const additionalFieldsContainer = document.getElementById('additionalFields');
            additionalFieldsContainer.innerHTML = '';

            additionalStudentFields.forEach(field => {
                const div = document.createElement('div');
                div.innerHTML = `
                    <label class="block text-sm font-medium text-gray-700 mb-2">${field.name}</label>
                    <input type="${field.type}" id="${field.id}" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                `;
                additionalFieldsContainer.appendChild(div);
            });
        }

        function editStudent(id) {
            const student = students.find(s => s.id === id);
            if (student) {
                selectedStudentId = id;
                // Populate form with student data
                document.getElementById('editStudentName').value = student.name;
                document.getElementById('editStudentClass').value = student.class;
                document.getElementById('editBirthPlace').value = student.birthPlace;
                document.getElementById('editBirthDate').value = student.birthDate;
                document.getElementById('editParentName').value = student.parentName;
                showModal('editStudentModal');
            }
        }

        // Edit student form handler
        document.getElementById('editStudentForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            if (selectedStudentId) {
                const student = students.find(s => s.id === selectedStudentId);
                if (student) {
                    student.name = document.getElementById('editStudentName').value;
                    student.class = document.getElementById('editStudentClass').value;
                    student.birthPlace = document.getElementById('editBirthPlace').value;
                    student.birthDate = document.getElementById('editBirthDate').value;
                    student.parentName = document.getElementById('editParentName').value;
                    
                    populateStudentsTable();
                    populateManualAttendance();
                    populateIndividualReports();
                    hideModal('editStudentModal');
                    
                    alert('Data siswa berhasil diperbarui!');
                    selectedStudentId = null;
                }
            }
        });

        function deleteStudent(id) {
            if (confirm('Apakah Anda yakin ingin menghapus data siswa ini?')) {
                students = students.filter(s => s.id !== id);
                populateStudentsTable();
                populateManualAttendance();
                alert('Data siswa berhasil dihapus!');
            }
        }

        // Manual attendance by class
        function populateManualAttendance() {
            populateClassAttendance('7', 'class7AttendanceList');
            populateClassAttendance('8', 'class8AttendanceList');
            populateClassAttendance('9', 'class9AttendanceList');
        }

        function populateClassAttendance(classNumber, containerId) {
            const container = document.getElementById(containerId);
            container.innerHTML = '';
            
            const classStudents = students.filter(student => student.class.startsWith(classNumber));
            
            classStudents.forEach(student => {
                const div = document.createElement('div');
                div.className = 'flex items-center justify-between p-4 bg-gray-50 rounded-lg';
                div.innerHTML = `
                    <div class="flex items-center">
                        <div class="text-2xl mr-4">${student.photo}</div>
                        <div>
                            <div class="font-medium text-gray-900">${student.name}</div>
                            <div class="text-sm text-gray-500">${student.class}</div>
                        </div>
                    </div>
                    <div class="flex space-x-2" id="attendance-buttons-${student.id}">
                        <button onclick="setAttendance(${student.id}, 'hadir')" class="attendance-btn bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm hover:bg-green-200">
                            Hadir
                        </button>
                        <button onclick="setAttendance(${student.id}, 'izin')" class="attendance-btn bg-yellow-100 text-yellow-800 px-3 py-1 rounded-full text-sm hover:bg-yellow-200">
                            Izin
                        </button>
                        <button onclick="setAttendance(${student.id}, 'sakit')" class="attendance-btn bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm hover:bg-blue-200">
                            Sakit
                        </button>
                        <button onclick="setAttendance(${student.id}, 'alpha')" class="attendance-btn bg-red-100 text-red-800 px-3 py-1 rounded-full text-sm hover:bg-red-200">
                            Alpha
                        </button>
                    </div>
                `;
                container.appendChild(div);
            });
        }

        function setAttendance(studentId, status) {
            const student = students.find(s => s.id === studentId);
            
            if (status === 'hadir') {
                // Open camera for photo when marking as present
                selectedStudentId = studentId;
                document.getElementById('studentPhotoInfo').innerHTML = `
                    <div class="flex items-center justify-center mb-2">
                        <div class="text-2xl mr-2">${student.photo}</div>
                        <div>
                            <div class="font-medium">${student.name}</div>
                            <div class="text-sm text-gray-600">${student.class}</div>
                        </div>
                    </div>
                    <p class="text-sm text-gray-600">Ambil foto untuk konfirmasi kehadiran</p>
                `;
                showModal('cameraModal');
            } else {
                // For other statuses, mark directly
                markAttendanceStatus(studentId, status);
            }
        }

        function markAttendanceStatus(studentId, status) {
            // Reset all buttons for this student
            const buttonsContainer = document.getElementById(`attendance-buttons-${studentId}`);
            const buttons = buttonsContainer.querySelectorAll('.attendance-btn');
            buttons.forEach(btn => {
                btn.classList.remove('ring-2', 'ring-offset-2', 'bg-opacity-100');
            });
            
            // Highlight selected button
            const selectedButton = Array.from(buttons).find(btn => btn.textContent.trim().toLowerCase() === status);
            if (selectedButton) {
                selectedButton.classList.add('ring-2', 'ring-offset-2', 'bg-opacity-100');
                
                // Add edit button
                if (!buttonsContainer.querySelector('.edit-btn')) {
                    const editBtn = document.createElement('button');
                    editBtn.className = 'edit-btn bg-gray-100 text-gray-600 px-2 py-1 rounded-full text-xs hover:bg-gray-200 ml-2';
                    editBtn.innerHTML = '<i class="fas fa-edit"></i>';
                    editBtn.onclick = () => editAttendance(studentId);
                    buttonsContainer.appendChild(editBtn);
                }
            }
            
            // Store attendance data
            attendanceData[studentId] = {
                status: status,
                timestamp: new Date().toISOString(),
                hasPhoto: status === 'hadir'
            };
        }

        function editAttendance(studentId) {
            // Remove edit button and reset selection
            const buttonsContainer = document.getElementById(`attendance-buttons-${studentId}`);
            const editBtn = buttonsContainer.querySelector('.edit-btn');
            if (editBtn) editBtn.remove();
            
            const buttons = buttonsContainer.querySelectorAll('.attendance-btn');
            buttons.forEach(btn => {
                btn.classList.remove('ring-2', 'ring-offset-2', 'bg-opacity-100');
            });
            
            // Remove from attendance data
            delete attendanceData[studentId];
        }

        function saveAttendance() {
            const attendanceCount = Object.keys(attendanceData).length;
            if (attendanceCount === 0) {
                alert('Belum ada data absensi yang diinput!');
                return;
            }
            
            // Store attendance data by date
            const today = new Date().toISOString().split('T')[0];
            const statusCounts = { hadir: 0, izin: 0, sakit: 0, alpha: 0 };
            Object.values(attendanceData).forEach(data => {
                statusCounts[data.status]++;
            });
            
            dailyAttendanceRecords[today] = {
                date: today,
                attendanceData: { ...attendanceData },
                statusCounts: { ...statusCounts },
                timestamp: new Date().toISOString()
            };
            
            // Show attendance summary
            const summaryContainer = document.getElementById('attendanceSummaryContent');
            let summaryHtml = '<div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-4">';
            
            summaryHtml += `
                <div class="text-center">
                    <div class="text-2xl font-bold text-green-600">${statusCounts.hadir}</div>
                    <div class="text-sm text-gray-600">Hadir</div>
                </div>
                <div class="text-center">
                    <div class="text-2xl font-bold text-yellow-600">${statusCounts.izin}</div>
                    <div class="text-sm text-gray-600">Izin</div>
                </div>
                <div class="text-center">
                    <div class="text-2xl font-bold text-blue-600">${statusCounts.sakit}</div>
                    <div class="text-sm text-gray-600">Sakit</div>
                </div>
                <div class="text-center">
                    <div class="text-2xl font-bold text-red-600">${statusCounts.alpha}</div>
                    <div class="text-sm text-gray-600">Alpha</div>
                </div>
            `;
            summaryHtml += '</div>';
            
            summaryHtml += '<div class="text-sm text-gray-600">';
            summaryHtml += `<p><strong>Total siswa diabsen:</strong> ${attendanceCount} dari ${students.length}</p>`;
            summaryHtml += `<p><strong>Waktu penyimpanan:</strong> ${new Date().toLocaleString('id-ID')}</p>`;
            summaryHtml += '</div>';
            
            summaryContainer.innerHTML = summaryHtml;
            document.getElementById('attendanceSummary').classList.remove('hidden');
            
            // Simulate saving to Google Drive and updating coach dashboard
            alert(`Absensi berhasil disimpan ke Google Drive dan dashboard pelatih telah diperbarui!`);
            
            // Add to admin activities
            adminActivities.unshift({
                id: adminActivities.length + 1,
                admin: 'Admin Paskibra',
                action: `Simpan absensi ${attendanceCount} siswa`,
                time: new Date().toISOString().replace('T', ' ').substring(0, 19),
                type: 'attendance'
            });
        }

        // QR Code scanning
        function startQRScan() {
            // Simulate QR scan result
            setTimeout(() => {
                const randomStudent = students[Math.floor(Math.random() * students.length)];
                document.getElementById('qrScanResult').classList.remove('hidden');
                document.getElementById('scannedStudentInfo').innerHTML = `
                    <div class="flex items-center mb-4">
                        <div class="text-3xl mr-4">${randomStudent.photo}</div>
                        <div>
                            <div class="font-semibold text-lg">${randomStudent.name}</div>
                            <div class="text-gray-600">${randomStudent.class}</div>
                            <div class="text-sm text-gray-500">${randomStudent.birthPlace}, ${new Date(randomStudent.birthDate).toLocaleDateString('id-ID')}</div>
                        </div>
                    </div>
                `;
                
                // Store scanned student ID for attendance marking
                window.scannedStudentId = randomStudent.id;
            }, 2000);
        }

        function markAttendance(status) {
            if (window.scannedStudentId) {
                const student = students.find(s => s.id === window.scannedStudentId);
                
                if (status === 'hadir') {
                    // Same process as manual attendance - open camera for photo
                    selectedStudentId = window.scannedStudentId;
                    document.getElementById('studentPhotoInfo').innerHTML = `
                        <div class="flex items-center justify-center mb-2">
                            <div class="text-2xl mr-2">${student.photo}</div>
                            <div>
                                <div class="font-medium">${student.name}</div>
                                <div class="text-sm text-gray-600">${student.class}</div>
                            </div>
                        </div>
                        <p class="text-sm text-gray-600">Ambil foto untuk konfirmasi kehadiran (QR Scan)</p>
                    `;
                    showModal('cameraModal');
                } else {
                    // For other statuses, mark directly
                    markAttendanceStatus(window.scannedStudentId, status);
                    alert(`${student.name} berhasil diabsen dengan status: ${status.toUpperCase()}`);
                }
                
                // Reset QR scan
                document.getElementById('qrScanResult').classList.add('hidden');
                window.scannedStudentId = null;
            }
        }

        // Assignments management
        function populateAssignments() {
            const container = document.getElementById('assignmentsList');
            container.innerHTML = '';
            
            assignments.forEach(assignment => {
                const div = document.createElement('div');
                div.className = 'bg-white rounded-lg card-shadow p-6 cursor-pointer hover:shadow-lg transition-all';
                div.onclick = () => showAssignmentDetail(assignment.id);
                div.innerHTML = `
                    <h3 class="font-semibold text-lg text-gray-800 mb-2">${assignment.title}</h3>
                    <p class="text-gray-600 mb-4">${assignment.description}</p>
                    <div class="flex justify-between items-center">
                        <span class="text-sm text-gray-500">Deadline: ${new Date(assignment.dueDate).toLocaleDateString('id-ID')}</span>
                        <span class="bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-sm">
                            ${assignment.submissions.length} submissions
                        </span>
                    </div>
                `;
                container.appendChild(div);
            });
        }

        function showAssignmentDetail(assignmentId) {
            const assignment = assignments.find(a => a.id === assignmentId);
            if (!assignment) return;
            
            const content = document.getElementById('assignmentDetailContent');
            content.innerHTML = `
                <div class="mb-6">
                    <h3 class="text-xl font-semibold text-gray-800 mb-2">${assignment.title}</h3>
                    <p class="text-gray-600 mb-4">${assignment.description}</p>
                    <p class="text-sm text-gray-500">Deadline: ${new Date(assignment.dueDate).toLocaleDateString('id-ID')}</p>
                </div>
                
                <div class="mb-6">
                    <h4 class="font-semibold text-gray-800 mb-4">Submissions (${assignment.submissions.length})</h4>
                    <div class="space-y-4">
                        ${assignment.submissions.length === 0 ? 
                            '<p class="text-gray-500 text-center py-8">Belum ada submission</p>' :
                            assignment.submissions.map(sub => `
                                <div class="border rounded-lg p-4">
                                    <div class="flex justify-between items-start mb-2">
                                        <div>
                                            <div class="font-medium">${sub.studentName}</div>
                                            <div class="text-sm text-gray-500">${sub.submittedAt}</div>
                                        </div>
                                        <div class="flex space-x-2">
                                            <input type="number" min="0" max="100" placeholder="Nilai" class="w-20 px-2 py-1 border rounded text-sm">
                                            <button onclick="gradeSubmission(${assignmentId}, ${sub.id})" class="bg-green-600 text-white px-3 py-1 rounded text-sm hover:bg-green-700">
                                                Nilai
                                            </button>
                                        </div>
                                    </div>
                                    <p class="text-gray-700">${sub.content}</p>
                                </div>
                            `).join('')
                        }
                    </div>
                </div>
                
                <div class="flex justify-end space-x-4">
                    <button onclick="printAssignmentReport(${assignmentId})" class="bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700">
                        <i class="fas fa-print mr-2"></i>Cetak Laporan
                    </button>
                    <button onclick="exportToGoogleDrive(${assignmentId})" class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700">
                        <i class="fas fa-cloud-upload-alt mr-2"></i>Export ke Drive
                    </button>
                </div>
            `;
            
            showModal('assignmentDetailModal');
        }

        function gradeSubmission(assignmentId, submissionId) {
            const gradeInput = event.target.previousElementSibling;
            const grade = gradeInput.value;
            
            if (grade >= 0 && grade <= 100) {
                alert(`Nilai ${grade} berhasil disimpan!`);
                gradeInput.disabled = true;
                event.target.textContent = 'Dinilai';
                event.target.disabled = true;
                event.target.classList.remove('bg-green-600', 'hover:bg-green-700');
                event.target.classList.add('bg-gray-400');
            } else {
                alert('Nilai harus antara 0-100!');
            }
        }

        // Student assignments
        function populateStudentAssignments() {
            const container = document.getElementById('studentAssignmentsList');
            container.innerHTML = '';
            
            assignments.forEach(assignment => {
                const dueDate = new Date(assignment.dueDate);
                const today = new Date();
                const timeDiff = dueDate.getTime() - today.getTime();
                const daysDiff = Math.ceil(timeDiff / (1000 * 3600 * 24));
                
                let statusBadge = '';
                let statusText = '';
                
                // Check if assignment is submitted (simulate random submission status)
                const isSubmitted = Math.random() > 0.5;
                
                if (isSubmitted) {
                    statusBadge = 'bg-green-100 text-green-800';
                    statusText = 'Selesai';
                } else if (daysDiff < 0) {
                    // Overdue
                    const overdueDays = Math.abs(daysDiff);
                    statusBadge = 'bg-red-100 text-red-800';
                    statusText = `Terlambat ${overdueDays} hari`;
                } else {
                    // Still time
                    statusBadge = 'bg-yellow-100 text-yellow-800';
                    statusText = `${daysDiff} hari lagi`;
                }
                
                const div = document.createElement('div');
                div.className = 'border rounded-lg p-4';
                div.innerHTML = `
                    <div class="flex justify-between items-start mb-2">
                        <div>
                            <h4 class="font-semibold text-gray-800">${assignment.title}</h4>
                            <p class="text-sm text-gray-600">${assignment.description}</p>
                            <p class="text-xs text-gray-500 mt-1">Deadline: ${dueDate.toLocaleDateString('id-ID')}</p>
                        </div>
                        <span class="${statusBadge} px-2 py-1 rounded-full text-xs">
                            ${statusText}
                        </span>
                    </div>
                `;
                container.appendChild(div);
            });
        }

        // Submit assignment form
        document.getElementById('submitAssignmentForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            if (!selectedAssignmentId) {
                alert('Pilih tugas terlebih dahulu!');
                return;
            }
            
            const answer = document.getElementById('assignmentAnswer').value;
            const file = document.getElementById('assignmentFile').files[0];
            
            if (answer.trim()) {
                const assignment = assignments.find(a => a.id === selectedAssignmentId);
                
                // Add submission to assignment
                const newSubmission = {
                    id: Date.now(),
                    studentName: currentUser ? currentUser.username : 'Unknown Student',
                    content: answer,
                    submittedAt: new Date().toLocaleDateString('id-ID'),
                    file: file ? file.name : null
                };
                
                assignment.submissions.push(newSubmission);
                
                // Add to student activities
                studentActivities.unshift({
                    id: studentActivities.length + 1,
                    student: currentUser ? currentUser.username : 'Unknown',
                    action: `Submit tugas: ${assignment.title}`,
                    time: new Date().toISOString().replace('T', ' ').substring(0, 19),
                    type: 'assignment'
                });
                
                // Simulate submission
                alert('Tugas berhasil disubmit dan disimpan ke Google Drive!');
                hideSubmitForm();
                populateStudentAssignments();
            }
        });

        // Add material form
        document.getElementById('addMaterialForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const title = document.getElementById('materialTitle').value;
            const description = document.getElementById('materialDescription').value;
            const file = document.getElementById('materialFile').files[0];
            
            if (title && description && file) {
                const newMaterial = {
                    id: materials.length + 1,
                    title: title,
                    description: description,
                    type: file.name.split('.').pop().toUpperCase(),
                    size: (file.size / 1024 / 1024).toFixed(1) + ' MB',
                    uploadDate: new Date().toISOString().split('T')[0]
                };
                
                materials.push(newMaterial);
                populateCoachMaterials();
                populateMaterials();
                hideModal('addMaterialModal');
                this.reset();
                
                alert('Materi berhasil ditambahkan dan tersedia untuk siswa!');
            }
        });

        // Edit photo form
        document.getElementById('editPhotoForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            if (selectedStudentId && selectedEmoji) {
                const student = students.find(s => s.id === selectedStudentId);
                student.photo = selectedEmoji;
                
                populateStudentsTable();
                hideModal('editPhotoModal');
                
                alert('Foto siswa berhasil diperbarui!');
                selectedStudentId = null;
                selectedEmoji = null;
            }
        });

        // Manage account form
        document.getElementById('manageAccountForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const username = document.getElementById('editUsername').value;
            const password = document.getElementById('editPassword').value;
            const confirmPassword = document.getElementById('editConfirmPassword').value;
            
            if (password && password !== confirmPassword) {
                alert('Password dan konfirmasi password tidak cocok!');
                return;
            }
            
            if (selectedStudentId) {
                const student = students.find(s => s.id === selectedStudentId);
                student.username = username;
                
                if (password) {
                    // In real app, password would be hashed
                    alert('Username dan password berhasil diperbarui!');
                } else {
                    alert('Username berhasil diperbarui!');
                }
                
                hideModal('manageAccountModal');
                populateStudentsTable();
                selectedStudentId = null;
            }
        });

        // Attendance chart for students
        function initAttendanceChart() {
            const ctx = document.getElementById('attendanceChart').getContext('2d');
            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'Mei', 'Jun'],
                    datasets: [{
                        label: 'Kehadiran (%)',
                        data: [95, 88, 92, 85, 90, 94],
                        borderColor: '#667eea',
                        backgroundColor: 'rgba(102, 126, 234, 0.1)',
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            ticks: {
                                callback: function(value) {
                                    return value + '%';
                                }
                            }
                        }
                    }
                }
            });
        }

        // Attendance overview chart for pelatih
        function initAttendanceOverviewChart() {
            const ctx = document.getElementById('attendanceOverviewChart').getContext('2d');
            attendanceOverviewChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Minggu 1', 'Minggu 2', 'Minggu 3', 'Minggu 4'],
                    datasets: [
                        {
                            label: 'Hadir',
                            data: [20, 18, 22, 19],
                            backgroundColor: '#10b981'
                        },
                        {
                            label: 'Izin',
                            data: [2, 3, 1, 2],
                            backgroundColor: '#f59e0b'
                        },
                        {
                            label: 'Sakit',
                            data: [1, 2, 1, 3],
                            backgroundColor: '#3b82f6'
                        },
                        {
                            label: 'Alpha',
                            data: [0, 1, 0, 1],
                            backgroundColor: '#ef4444'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    scales: {
                        x: {
                            stacked: true
                        },
                        y: {
                            stacked: true,
                            beginAtZero: true
                        }
                    }
                }
            });
        }

        function filterAttendanceData() {
            const startDate = document.getElementById('startDate').value;
            const endDate = document.getElementById('endDate').value;
            
            if (startDate && endDate) {
                // Simulate filtering data
                alert(`Data absensi difilter dari ${new Date(startDate).toLocaleDateString('id-ID')} sampai ${new Date(endDate).toLocaleDateString('id-ID')}`);
                
                // Update statistics (simulated)
                document.getElementById('totalHadir').textContent = '82%';
                document.getElementById('totalIzin').textContent = '10%';
                document.getElementById('totalSakit').textContent = '6%';
                document.getElementById('totalAlpha').textContent = '2%';
            } else {
                alert('Pilih rentang tanggal terlebih dahulu!');
            }
        }

        function populateIndividualReports() {
            const container = document.getElementById('individualReports');
            container.innerHTML = '';

            students.forEach(student => {
                const div = document.createElement('div');
                div.className = 'bg-gray-50 rounded-lg p-4 cursor-pointer hover:bg-gray-100 transition-all';
                div.onclick = () => showIndividualReport(student.id);
                div.innerHTML = `
                    <div class="flex items-center mb-2">
                        <div class="text-xl mr-3">${student.photo}</div>
                        <div>
                            <div class="font-medium text-gray-800">${student.name}</div>
                            <div class="text-sm text-gray-600">${student.class}</div>
                        </div>
                    </div>
                    <div class="text-sm text-gray-500">
                        Tugas diselesaikan: ${Math.floor(Math.random() * assignments.length)}/${assignments.length}
                    </div>
                `;
                container.appendChild(div);
            });
        }

        function showIndividualReport(studentId) {
            const student = students.find(s => s.id === studentId);
            if (!student) return;

            let reportHtml = `
                <div class="mb-6">
                    <div class="flex items-center mb-4">
                        <div class="text-3xl mr-4">${student.photo}</div>
                        <div>
                            <h3 class="text-xl font-semibold text-gray-800">${student.name}</h3>
                            <p class="text-gray-600">${student.class}</p>
                        </div>
                    </div>
                </div>
                
                <div class="space-y-4">
                    <h4 class="font-semibold text-gray-800">Laporan Tugas:</h4>
            `;

            assignments.forEach(assignment => {
                const hasSubmitted = Math.random() > 0.3; // Simulate submission
                const grade = hasSubmitted ? Math.floor(Math.random() * 40) + 60 : null;
                
                reportHtml += `
                    <div class="border rounded-lg p-4">
                        <div class="flex justify-between items-start">
                            <div>
                                <div class="font-medium">${assignment.title}</div>
                                <div class="text-sm text-gray-600">${assignment.description}</div>
                                <div class="text-xs text-gray-500">Deadline: ${new Date(assignment.dueDate).toLocaleDateString('id-ID')}</div>
                            </div>
                            <div class="text-right">
                                ${hasSubmitted ? 
                                    `<span class="bg-green-100 text-green-800 px-2 py-1 rounded-full text-xs">Selesai</span>
                                     <div class="text-sm font-semibold mt-1">Nilai: ${grade}</div>` :
                                    `<span class="bg-red-100 text-red-800 px-2 py-1 rounded-full text-xs">Belum</span>`
                                }
                            </div>
                        </div>
                    </div>
                `;
            });

            reportHtml += `
                </div>
                <div class="mt-6 flex justify-end">
                    <button onclick="printIndividualReport('${student.name}')" class="bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700">
                        <i class="fas fa-print mr-2"></i>Cetak Laporan
                    </button>
                </div>
            `;

            document.getElementById('assignmentDetailContent').innerHTML = reportHtml;
            showModal('assignmentDetailModal');
        }

        function printIndividualReport(studentName) {
            alert(`Laporan tugas ${studentName} berhasil dicetak!`);
        }

        // Utility functions
        function showModal(modalId) {
            document.getElementById(modalId).classList.remove('hidden');
        }

        function hideModal(modalId) {
            document.getElementById(modalId).classList.add('hidden');
        }

        function importFromSpreadsheet() {
            alert('Fitur import dari Google Spreadsheet akan segera tersedia!');
        }

        function printData() {
            window.print();
        }

        function printAssignmentReport(assignmentId) {
            alert('Laporan tugas berhasil dicetak!');
        }

        function exportToGoogleDrive(assignmentId) {
            alert('Data berhasil diekspor ke Google Drive!');
        }

        // Student profile functions
        function loadStudentProfile(username) {
            // Find student data based on username (simulate login)
            const student = students.find(s => s.name.toLowerCase().replace(/\s+/g, '.') === username) || students[0];
            
            document.getElementById('studentProfileName').textContent = student.name;
            document.getElementById('studentProfileClass').textContent = `Kelas ${student.class}`;
            document.getElementById('studentProfileId').textContent = `ID: 2024${student.id.toString().padStart(3, '0')}`;
            document.getElementById('profileFullName').textContent = student.name;
            document.getElementById('profileBirthInfo').textContent = `${student.birthPlace}, ${new Date(student.birthDate).toLocaleDateString('id-ID')}`;
            document.getElementById('profileClass').textContent = student.class;
            document.getElementById('profileParentName').textContent = student.parentName;
            document.getElementById('profileUsername').textContent = username;
        }

        // Edit coach login form handler
        document.getElementById('editCoachLoginForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const newUsername = document.getElementById('newCoachUsername').value;
            const newPassword = document.getElementById('newCoachPassword').value;
            const confirmPassword = document.getElementById('confirmCoachPassword').value;
            
            if (newPassword !== confirmPassword) {
                alert('Password baru dan konfirmasi password tidak cocok!');
                return;
            }
            
            if (newPassword.length < 6) {
                alert('Password minimal 6 karakter!');
                return;
            }
            
            // Update coach credentials
            coachCredentials.username = newUsername;
            coachCredentials.password = newPassword;
            
            // Update display
            document.getElementById('currentCoachUsername').textContent = newUsername;
            
            alert('Info login pelatih berhasil diperbarui!');
            hideModal('editCoachLoginModal');
            this.reset();
        });

        // Change password form
        document.getElementById('changePasswordForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const oldPassword = document.getElementById('oldPassword').value;
            const newPassword = document.getElementById('newPassword').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            
            if (newPassword !== confirmPassword) {
                alert('Password baru dan konfirmasi password tidak cocok!');
                return;
            }
            
            if (newPassword.length < 6) {
                alert('Password baru minimal 6 karakter!');
                return;
            }
            
            // Simulate password change
            alert('Password berhasil diubah!');
            this.reset();
        });

        // Materials functions
        function populateMaterials() {
            const container = document.getElementById('materialsList');
            container.innerHTML = '';
            
            materials.forEach(material => {
                const div = document.createElement('div');
                div.className = 'bg-white rounded-lg card-shadow p-6 hover:shadow-lg transition-all';
                
                const typeIcon = material.type === 'PDF' ? 'fas fa-file-pdf text-red-500' : 
                               material.type === 'MP4' ? 'fas fa-play-circle text-blue-500' : 
                               'fas fa-file text-gray-500';
                
                div.innerHTML = `
                    <div class="flex items-start mb-4">
                        <div class="w-12 h-12 bg-gray-100 rounded-lg flex items-center justify-center mr-4">
                            <i class="${typeIcon} text-xl"></i>
                        </div>
                        <div class="flex-1">
                            <h3 class="font-semibold text-gray-800 mb-1">${material.title}</h3>
                            <p class="text-sm text-gray-600 mb-2">${material.description}</p>
                            <div class="flex items-center text-xs text-gray-500 space-x-4">
                                <span><i class="fas fa-file-alt mr-1"></i>${material.type}</span>
                                <span><i class="fas fa-hdd mr-1"></i>${material.size}</span>
                                <span><i class="fas fa-calendar mr-1"></i>${new Date(material.uploadDate).toLocaleDateString('id-ID')}</span>
                            </div>
                        </div>
                    </div>
                    <button onclick="downloadMaterial(${material.id})" class="w-full btn-primary text-white py-2 rounded-lg hover:shadow-lg transition-all">
                        <i class="fas fa-download mr-2"></i>Download
                    </button>
                `;
                container.appendChild(div);
            });
        }

        function downloadMaterial(materialId) {
            const material = materials.find(m => m.id === materialId);
            if (material) {
                // Simulate download
                alert(`Mengunduh "${material.title}"...`);
                
                // Add to student activities
                studentActivities.unshift({
                    id: studentActivities.length + 1,
                    student: currentUser ? currentUser.username : 'Unknown',
                    action: `Download materi: ${material.title}`,
                    time: new Date().toISOString().replace('T', ' ').substring(0, 19),
                    type: 'material'
                });
                
                // In a real application, this would trigger an actual download
                // For demo purposes, we'll just show a success message
                setTimeout(() => {
                    alert(`"${material.title}" berhasil diunduh!`);
                }, 1000);
            }
        }

        // Assignment selection functions
        function populateAssignmentSelection() {
            const container = document.getElementById('assignmentSelectionList');
            container.innerHTML = '';
            
            assignments.forEach(assignment => {
                const div = document.createElement('div');
                div.className = 'border rounded-lg p-4 hover:bg-gray-50 cursor-pointer transition-all';
                div.onclick = () => selectAssignment(assignment.id);
                
                const dueDate = new Date(assignment.dueDate);
                const isOverdue = dueDate < new Date();
                
                div.innerHTML = `
                    <div class="flex justify-between items-start mb-2">
                        <h4 class="font-semibold text-gray-800">${assignment.title}</h4>
                        <span class="text-xs px-2 py-1 rounded-full ${isOverdue ? 'bg-red-100 text-red-800' : 'bg-blue-100 text-blue-800'}">
                            ${isOverdue ? 'Terlambat' : 'Aktif'}
                        </span>
                    </div>
                    <p class="text-sm text-gray-600 mb-3">${assignment.description}</p>
                    <div class="flex justify-between items-center text-xs text-gray-500">
                        <span>Deadline: ${dueDate.toLocaleDateString('id-ID')}</span>
                        <button class="bg-blue-600 text-white px-3 py-1 rounded hover:bg-blue-700 transition-all">
                            Pilih Tugas
                        </button>
                    </div>
                `;
                container.appendChild(div);
            });
        }

        function selectAssignment(assignmentId) {
            selectedAssignmentId = assignmentId;
            const assignment = assignments.find(a => a.id === assignmentId);
            
            // Show assignment info
            document.getElementById('selectedAssignmentInfo').innerHTML = `
                <h4 class="font-semibold text-gray-800 mb-2">${assignment.title}</h4>
                <p class="text-sm text-gray-600 mb-2">${assignment.description}</p>
                <p class="text-xs text-gray-500">Deadline: ${new Date(assignment.dueDate).toLocaleDateString('id-ID')}</p>
            `;
            
            // Show submit form
            document.getElementById('availableAssignments').classList.add('hidden');
            document.getElementById('submitAssignmentSection').classList.remove('hidden');
        }

        function hideSubmitForm() {
            document.getElementById('availableAssignments').classList.remove('hidden');
            document.getElementById('submitAssignmentSection').classList.add('hidden');
            document.getElementById('submitAssignmentForm').reset();
            selectedAssignmentId = null;
        }

        // Coach materials functions
        function populateCoachMaterials() {
            const container = document.getElementById('coachMaterialsList');
            container.innerHTML = '';
            
            materials.forEach(material => {
                const div = document.createElement('div');
                div.className = 'bg-white rounded-lg card-shadow p-6';
                
                const typeIcon = material.type === 'PDF' ? 'fas fa-file-pdf text-red-500' : 
                               material.type === 'MP4' ? 'fas fa-play-circle text-blue-500' : 
                               'fas fa-file text-gray-500';
                
                div.innerHTML = `
                    <div class="flex items-start mb-4">
                        <div class="w-12 h-12 bg-gray-100 rounded-lg flex items-center justify-center mr-4">
                            <i class="${typeIcon} text-xl"></i>
                        </div>
                        <div class="flex-1">
                            <h3 class="font-semibold text-gray-800 mb-1">${material.title}</h3>
                            <p class="text-sm text-gray-600 mb-2">${material.description}</p>
                            <div class="flex items-center text-xs text-gray-500 space-x-4">
                                <span><i class="fas fa-file-alt mr-1"></i>${material.type}</span>
                                <span><i class="fas fa-hdd mr-1"></i>${material.size}</span>
                                <span><i class="fas fa-calendar mr-1"></i>${new Date(material.uploadDate).toLocaleDateString('id-ID')}</span>
                            </div>
                        </div>
                    </div>
                    <div class="flex space-x-2">
                        <button onclick="editMaterial(${material.id})" class="flex-1 bg-blue-600 text-white py-2 rounded-lg hover:bg-blue-700 transition-all">
                            <i class="fas fa-edit mr-2"></i>Edit
                        </button>
                        <button onclick="deleteMaterial(${material.id})" class="flex-1 bg-red-600 text-white py-2 rounded-lg hover:bg-red-700 transition-all">
                            <i class="fas fa-trash mr-2"></i>Hapus
                        </button>
                    </div>
                `;
                container.appendChild(div);
            });
        }

        function editMaterial(materialId) {
            const material = materials.find(m => m.id === materialId);
            if (material) {
                document.getElementById('materialTitle').value = material.title;
                document.getElementById('materialDescription').value = material.description;
                showModal('addMaterialModal');
            }
        }

        function deleteMaterial(materialId) {
            if (confirm('Apakah Anda yakin ingin menghapus materi ini?')) {
                const index = materials.findIndex(m => m.id === materialId);
                if (index > -1) {
                    materials.splice(index, 1);
                    populateCoachMaterials();
                    populateMaterials();
                    alert('Materi berhasil dihapus!');
                }
            }
        }

        // Photo management functions
        function editStudentPhoto(studentId) {
            selectedStudentId = studentId;
            const student = students.find(s => s.id === studentId);
            document.getElementById('currentPhotoDisplay').textContent = student.photo;
            showModal('editPhotoModal');
        }

        function selectEmoji(emoji) {
            selectedEmoji = emoji;
            document.getElementById('currentPhotoDisplay').textContent = emoji;
            
            // Highlight selected emoji
            document.querySelectorAll('.emoji-btn').forEach(btn => {
                btn.classList.remove('ring-2', 'ring-blue-500');
            });
            event.target.classList.add('ring-2', 'ring-blue-500');
        }

        // Account management functions
        function manageStudentAccount(studentId) {
            selectedStudentId = studentId;
            const student = students.find(s => s.id === studentId);
            
            document.getElementById('studentAccountInfo').innerHTML = `
                <div class="flex items-center mb-4">
                    <div class="text-2xl mr-3">${student.photo}</div>
                    <div>
                        <div class="font-medium text-gray-800">${student.name}</div>
                        <div class="text-sm text-gray-600">${student.class}</div>
                    </div>
                </div>
            `;
            
            document.getElementById('editUsername').value = student.username || '';
            showModal('manageAccountModal');
        }

        // Activity functions
        function populateActivities() {
            populateStudentActivities();
            populateAdminActivities();
        }

        function populateStudentActivities() {
            const container = document.getElementById('studentActivityList');
            container.innerHTML = '';
            
            studentActivities.slice(0, 20).forEach(activity => {
                const div = document.createElement('div');
                div.className = 'flex items-center justify-between p-3 border-b border-gray-200';
                
                const typeIcon = activity.type === 'login' ? 'fas fa-sign-in-alt text-green-600' :
                               activity.type === 'assignment' ? 'fas fa-tasks text-blue-600' :
                               activity.type === 'material' ? 'fas fa-download text-purple-600' :
                               'fas fa-user-cog text-orange-600';
                
                div.innerHTML = `
                    <div class="flex items-center">
                        <div class="w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center mr-3">
                            <i class="${typeIcon} text-sm"></i>
                        </div>
                        <div>
                            <div class="font-medium text-sm text-gray-800">${activity.student}</div>
                            <div class="text-xs text-gray-600">${activity.action}</div>
                        </div>
                    </div>
                    <div class="text-xs text-gray-500">
                        ${new Date(activity.time).toLocaleString('id-ID')}
                    </div>
                `;
                container.appendChild(div);
            });
        }

        function populateAdminActivities() {
            const container = document.getElementById('adminActivityList');
            container.innerHTML = '';
            
            adminActivities.slice(0, 20).forEach(activity => {
                const div = document.createElement('div');
                div.className = 'flex items-center justify-between p-3 border-b border-gray-200';
                
                const typeIcon = activity.type === 'login' ? 'fas fa-sign-in-alt text-green-600' :
                               activity.type === 'attendance' ? 'fas fa-clipboard-check text-blue-600' :
                               'fas fa-cog text-gray-600';
                
                div.innerHTML = `
                    <div class="flex items-center">
                        <div class="w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center mr-3">
                            <i class="${typeIcon} text-sm"></i>
                        </div>
                        <div>
                            <div class="font-medium text-sm text-gray-800">${activity.admin}</div>
                            <div class="text-xs text-gray-600">${activity.action}</div>
                        </div>
                    </div>
                    <div class="text-xs text-gray-500">
                        ${new Date(activity.time).toLocaleString('id-ID')}
                    </div>
                `;
                container.appendChild(div);
            });
        }

        function showActivityTab(tab) {
            // Update tab buttons
            document.querySelectorAll('.activity-tab-btn').forEach(btn => {
                btn.classList.remove('bg-blue-600', 'text-white');
                btn.classList.add('bg-gray-300', 'text-gray-700');
            });
            event.target.classList.remove('bg-gray-300', 'text-gray-700');
            event.target.classList.add('bg-blue-600', 'text-white');
            
            // Show/hide content
            document.querySelectorAll('.activity-content').forEach(content => {
                content.classList.add('hidden');
            });
            
            if (tab === 'siswa') {
                document.getElementById('studentActivities').classList.remove('hidden');
            } else {
                document.getElementById('adminActivities').classList.remove('hidden');
            }
        }

        // Account tab management functions
        function showAccountTab(tab) {
            // Update tab buttons
            document.querySelectorAll('.account-tab-btn').forEach(btn => {
                btn.classList.remove('bg-blue-600', 'bg-green-600', 'text-white');
                btn.classList.add('bg-gray-300', 'text-gray-700');
            });
            
            // Show/hide content
            document.querySelectorAll('.account-tab-content').forEach(content => {
                content.classList.add('hidden');
            });
            
            if (tab === 'pelatih') {
                event.target.classList.remove('bg-gray-300', 'text-gray-700');
                event.target.classList.add('bg-blue-600', 'text-white');
                document.getElementById('pelatihAccountTab').classList.remove('hidden');
            } else if (tab === 'admin') {
                event.target.classList.remove('bg-gray-300', 'text-gray-700');
                event.target.classList.add('bg-green-600', 'text-white');
                document.getElementById('adminAccountTab').classList.remove('hidden');
                populateAdminAccountsList();
            }
        }

        function populateAdminAccountsList() {
            const container = document.getElementById('adminAccountsList');
            container.innerHTML = '';
            
            adminAccounts.forEach(admin => {
                const div = document.createElement('div');
                div.className = 'flex justify-between items-center p-3 bg-white rounded-lg border';
                div.innerHTML = `
                    <div>
                        <div class="font-medium text-gray-800">${admin.username}</div>
                        <div class="text-sm text-gray-500">Dibuat: ${new Date(admin.createdAt).toLocaleDateString('id-ID')}</div>
                    </div>
                    <div class="flex space-x-2">
                        <button onclick="editAdminAccount(${admin.id})" class="text-blue-600 hover:text-blue-800" title="Edit">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button onclick="deleteAdminAccount(${admin.id})" class="text-red-600 hover:text-red-800" title="Hapus">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                `;
                container.appendChild(div);
            });
        }

        function editAdminAccount(adminId) {
            const admin = adminAccounts.find(a => a.id === adminId);
            if (admin) {
                document.getElementById('newAdminUsername').value = admin.username;
                document.getElementById('newAdminPassword').value = admin.password;
                document.getElementById('confirmAdminPassword').value = admin.password;
                
                // Store ID for editing
                window.editingAdminId = adminId;
                
                // Change button text
                const submitBtn = document.querySelector('#addAdminForm button[type="submit"]');
                submitBtn.innerHTML = '<i class="fas fa-save mr-2"></i>Update Admin';
                submitBtn.classList.remove('bg-green-600', 'hover:bg-green-700');
                submitBtn.classList.add('bg-blue-600', 'hover:bg-blue-700');
            }
        }

        function deleteAdminAccount(adminId) {
            if (adminAccounts.length <= 1) {
                alert('Tidak dapat menghapus akun admin terakhir!');
                return;
            }
            
            if (confirm('Apakah Anda yakin ingin menghapus akun admin ini?')) {
                const index = adminAccounts.findIndex(a => a.id === adminId);
                if (index > -1) {
                    adminAccounts.splice(index, 1);
                    populateAdminAccountsList();
                    alert('Akun admin berhasil dihapus!');
                }
            }
        }

        // Add admin form handler
        document.getElementById('addAdminForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const username = document.getElementById('newAdminUsername').value;
            const password = document.getElementById('newAdminPassword').value;
            const confirmPassword = document.getElementById('confirmAdminPassword').value;
            
            if (password !== confirmPassword) {
                alert('Password dan konfirmasi password tidak cocok!');
                return;
            }
            
            if (password.length < 6) {
                alert('Password minimal 6 karakter!');
                return;
            }
            
            // Check if username already exists (except when editing)
            const existingAdmin = adminAccounts.find(admin => admin.username === username);
            if (existingAdmin && (!window.editingAdminId || existingAdmin.id !== window.editingAdminId)) {
                alert('Username admin sudah digunakan!');
                return;
            }
            
            if (window.editingAdminId) {
                // Edit existing admin
                const admin = adminAccounts.find(a => a.id === window.editingAdminId);
                admin.username = username;
                admin.password = password;
                
                alert('Akun admin berhasil diperbarui!');
                window.editingAdminId = null;
                
                // Reset button
                const submitBtn = document.querySelector('#addAdminForm button[type="submit"]');
                submitBtn.innerHTML = '<i class="fas fa-plus mr-2"></i>Tambah Admin';
                submitBtn.classList.remove('bg-blue-600', 'hover:bg-blue-700');
                submitBtn.classList.add('bg-green-600', 'hover:bg-green-700');
            } else {
                // Add new admin
                const newAdmin = {
                    id: adminAccounts.length + 1,
                    username: username,
                    password: password,
                    createdAt: new Date().toISOString().split('T')[0]
                };
                
                adminAccounts.push(newAdmin);
                alert('Akun admin baru berhasil ditambahkan!');
            }
            
            populateAdminAccountsList();
            this.reset();
        });

        // Info Akun tab functions
        function showInfoAkunTab(tab) {
            // Update tab buttons
            document.querySelectorAll('.info-akun-tab-btn').forEach(btn => {
                btn.classList.remove('bg-blue-600', 'bg-green-600', 'bg-purple-600', 'text-white');
                btn.classList.add('bg-gray-300', 'text-gray-700');
            });
            
            // Show/hide content
            document.querySelectorAll('.info-akun-content').forEach(content => {
                content.classList.add('hidden');
            });
            
            if (tab === 'pelatih') {
                event.target.classList.remove('bg-gray-300', 'text-gray-700');
                event.target.classList.add('bg-blue-600', 'text-white');
                document.getElementById('pelatihInfoTab').classList.remove('hidden');
            } else if (tab === 'admin') {
                event.target.classList.remove('bg-gray-300', 'text-gray-700');
                event.target.classList.add('bg-green-600', 'text-white');
                document.getElementById('adminInfoTab').classList.remove('hidden');
                populatePelatihAdminAccountsList();
            } else if (tab === 'aktivitas') {
                event.target.classList.remove('bg-gray-300', 'text-gray-700');
                event.target.classList.add('bg-purple-600', 'text-white');
                document.getElementById('aktivitasInfoTab').classList.remove('hidden');
                
                // Set default dates for activity filter
                const today = new Date();
                const firstDay = new Date(today.getFullYear(), today.getMonth(), 1);
                document.getElementById('activityStartDate').valueAsDate = firstDay;
                document.getElementById('activityEndDate').valueAsDate = today;
                
                // Populate activities
                populateAccountActivities();
            }
        }

        // Activity type tab functions
        function showActivityTypeTab(type) {
            // Update tab buttons
            document.querySelectorAll('.activity-type-tab-btn').forEach(btn => {
                btn.classList.remove('bg-blue-600', 'bg-green-600', 'bg-purple-600', 'text-white');
                btn.classList.add('bg-gray-300', 'text-gray-700');
            });
            
            // Show/hide content
            document.querySelectorAll('.activity-type-content').forEach(content => {
                content.classList.add('hidden');
            });
            
            if (type === 'admin') {
                event.target.classList.remove('bg-gray-300', 'text-gray-700');
                event.target.classList.add('bg-blue-600', 'text-white');
                document.getElementById('adminActivitiesTab').classList.remove('hidden');
                populateAdminActivitiesList();
            } else if (type === 'siswa') {
                event.target.classList.remove('bg-gray-300', 'text-gray-700');
                event.target.classList.add('bg-green-600', 'text-white');
                document.getElementById('siswaActivitiesTab').classList.remove('hidden');
                populateSiswaActivitiesList();
            } else if (type === 'semua') {
                event.target.classList.remove('bg-gray-300', 'text-gray-700');
                event.target.classList.add('bg-purple-600', 'text-white');
                document.getElementById('semuaActivitiesTab').classList.remove('hidden');
                populateSemuaActivitiesList();
            }
        }

        // Populate account activities
        function populateAccountActivities() {
            populateAdminActivitiesList();
            populateSiswaActivitiesList();
            populateSemuaActivitiesList();
        }

        function populateAdminActivitiesList() {
            const container = document.getElementById('adminActivitiesList');
            container.innerHTML = '';
            
            adminActivities.slice(0, 50).forEach(activity => {
                const div = document.createElement('div');
                div.className = 'flex items-center justify-between p-3 bg-white rounded-lg border hover:shadow-sm transition-all';
                
                const typeIcon = activity.type === 'login' ? 'fas fa-sign-in-alt text-green-600' :
                               activity.type === 'attendance' ? 'fas fa-clipboard-check text-blue-600' :
                               'fas fa-cog text-gray-600';
                
                div.innerHTML = `
                    <div class="flex items-center">
                        <div class="w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center mr-3">
                            <i class="${typeIcon} text-sm"></i>
                        </div>
                        <div>
                            <div class="font-medium text-sm text-gray-800">${activity.admin}</div>
                            <div class="text-xs text-gray-600">${activity.action}</div>
                        </div>
                    </div>
                    <div class="text-xs text-gray-500">
                        ${new Date(activity.time).toLocaleString('id-ID')}
                    </div>
                `;
                container.appendChild(div);
            });
        }

        function populateSiswaActivitiesList() {
            const container = document.getElementById('siswaActivitiesList');
            container.innerHTML = '';
            
            studentActivities.slice(0, 50).forEach(activity => {
                const div = document.createElement('div');
                div.className = 'flex items-center justify-between p-3 bg-white rounded-lg border hover:shadow-sm transition-all';
                
                const typeIcon = activity.type === 'login' ? 'fas fa-sign-in-alt text-green-600' :
                               activity.type === 'assignment' ? 'fas fa-tasks text-blue-600' :
                               activity.type === 'material' ? 'fas fa-download text-purple-600' :
                               'fas fa-user-cog text-orange-600';
                
                div.innerHTML = `
                    <div class="flex items-center">
                        <div class="w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center mr-3">
                            <i class="${typeIcon} text-sm"></i>
                        </div>
                        <div>
                            <div class="font-medium text-sm text-gray-800">${activity.student}</div>
                            <div class="text-xs text-gray-600">${activity.action}</div>
                        </div>
                    </div>
                    <div class="text-xs text-gray-500">
                        ${new Date(activity.time).toLocaleString('id-ID')}
                    </div>
                `;
                container.appendChild(div);
            });
        }

        function populateSemuaActivitiesList() {
            const container = document.getElementById('semuaActivitiesList');
            container.innerHTML = '';
            
            // Combine and sort all activities by time
            const allActivities = [
                ...adminActivities.map(a => ({ ...a, userType: 'admin', user: a.admin })),
                ...studentActivities.map(a => ({ ...a, userType: 'student', user: a.student }))
            ].sort((a, b) => new Date(b.time) - new Date(a.time));
            
            allActivities.slice(0, 50).forEach(activity => {
                const div = document.createElement('div');
                div.className = 'flex items-center justify-between p-3 bg-white rounded-lg border hover:shadow-sm transition-all';
                
                const typeIcon = activity.type === 'login' ? 'fas fa-sign-in-alt text-green-600' :
                               activity.type === 'assignment' ? 'fas fa-tasks text-blue-600' :
                               activity.type === 'material' ? 'fas fa-download text-purple-600' :
                               activity.type === 'attendance' ? 'fas fa-clipboard-check text-blue-600' :
                               'fas fa-user-cog text-orange-600';
                
                const userTypeIcon = activity.userType === 'admin' ? 'fas fa-user-shield text-blue-500' : 'fas fa-user-graduate text-green-500';
                
                div.innerHTML = `
                    <div class="flex items-center">
                        <div class="w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center mr-3">
                            <i class="${typeIcon} text-sm"></i>
                        </div>
                        <div>
                            <div class="flex items-center">
                                <span class="font-medium text-sm text-gray-800 mr-2">${activity.user}</span>
                                <i class="${userTypeIcon} text-xs" title="${activity.userType === 'admin' ? 'Admin' : 'Siswa'}"></i>
                            </div>
                            <div class="text-xs text-gray-600">${activity.action}</div>
                        </div>
                    </div>
                    <div class="text-xs text-gray-500">
                        ${new Date(activity.time).toLocaleString('id-ID')}
                    </div>
                `;
                container.appendChild(div);
            });
        }

        // Filter account activities
        function filterAccountActivities() {
            const startDate = document.getElementById('activityStartDate').value;
            const endDate = document.getElementById('activityEndDate').value;
            
            if (startDate && endDate) {
                alert(`Filter aktivitas dari ${new Date(startDate).toLocaleDateString('id-ID')} sampai ${new Date(endDate).toLocaleDateString('id-ID')}`);
                
                // Update statistics (simulated)
                document.getElementById('todayLogins').textContent = Math.floor(Math.random() * 20) + 5;
                document.getElementById('todaySubmissions').textContent = Math.floor(Math.random() * 15) + 3;
                document.getElementById('todayDownloads').textContent = Math.floor(Math.random() * 25) + 10;
                document.getElementById('todayAttendance').textContent = Math.floor(Math.random() * 5) + 1;
                
                // Refresh activity lists
                populateAccountActivities();
            } else {
                alert('Pilih rentang tanggal terlebih dahulu!');
            }
        }

        // Export functions
        function exportActivitiesToCSV() {
            alert('Data aktivitas berhasil diekspor ke file CSV!');
        }

        function printActivitiesReport() {
            alert('Laporan aktivitas akun berhasil dicetak!');
        }

        function populatePelatihAdminAccountsList() {
            const container = document.getElementById('pelatihAdminAccountsList');
            container.innerHTML = '';
            
            adminAccounts.forEach(admin => {
                const div = document.createElement('div');
                div.className = 'flex justify-between items-center p-3 bg-white rounded-lg border';
                div.innerHTML = `
                    <div>
                        <div class="font-medium text-gray-800">${admin.username}</div>
                        <div class="text-sm text-gray-500">Dibuat: ${new Date(admin.createdAt).toLocaleDateString('id-ID')}</div>
                    </div>
                    <div class="flex space-x-2">
                        <button onclick="editPelatihAdminAccount(${admin.id})" class="text-blue-600 hover:text-blue-800" title="Edit">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button onclick="deletePelatihAdminAccount(${admin.id})" class="text-red-600 hover:text-red-800" title="Hapus">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                `;
                container.appendChild(div);
            });
        }

        function editPelatihAdminAccount(adminId) {
            const admin = adminAccounts.find(a => a.id === adminId);
            if (admin) {
                document.getElementById('pelatihNewAdminUsername').value = admin.username;
                document.getElementById('pelatihNewAdminPassword').value = admin.password;
                document.getElementById('pelatihConfirmAdminPassword').value = admin.password;
                
                // Store ID for editing
                window.editingPelatihAdminId = adminId;
                
                // Change button text
                const submitBtn = document.querySelector('#pelatihAddAdminForm button[type="submit"]');
                submitBtn.innerHTML = '<i class="fas fa-save mr-2"></i>Update Admin';
                submitBtn.classList.remove('bg-green-600', 'hover:bg-green-700');
                submitBtn.classList.add('bg-blue-600', 'hover:bg-blue-700');
            }
        }

        function deletePelatihAdminAccount(adminId) {
            if (adminAccounts.length <= 1) {
                alert('Tidak dapat menghapus akun admin terakhir!');
                return;
            }
            
            if (confirm('Apakah Anda yakin ingin menghapus akun admin ini?')) {
                const index = adminAccounts.findIndex(a => a.id === adminId);
                if (index > -1) {
                    adminAccounts.splice(index, 1);
                    populatePelatihAdminAccountsList();
                    populateAdminAccountsList();
                    alert('Akun admin berhasil dihapus!');
                }
            }
        }

        // Update Pelatih form handler
        document.getElementById('updatePelatihForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const username = document.getElementById('newPelatihUsername').value;
            const password = document.getElementById('newPelatihPassword').value;
            const confirmPassword = document.getElementById('confirmPelatihPassword').value;
            
            if (password !== confirmPassword) {
                alert('Password baru dan konfirmasi password tidak cocok!');
                return;
            }
            
            if (password.length < 6) {
                alert('Password minimal 6 karakter!');
                return;
            }
            
            // Update coach credentials
            coachCredentials.username = username;
            coachCredentials.password = password;
            
            // Update display
            document.getElementById('currentPelatihUsername').textContent = username;
            
            alert('Info akun pelatih berhasil diperbarui!');
            this.reset();
        });

        // Pelatih Add admin form handler
        document.getElementById('pelatihAddAdminForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const username = document.getElementById('pelatihNewAdminUsername').value;
            const password = document.getElementById('pelatihNewAdminPassword').value;
            const confirmPassword = document.getElementById('pelatihConfirmAdminPassword').value;
            
            if (password !== confirmPassword) {
                alert('Password dan konfirmasi password tidak cocok!');
                return;
            }
            
            if (password.length < 6) {
                alert('Password minimal 6 karakter!');
                return;
            }
            
            // Check if username already exists (except when editing)
            const existingAdmin = adminAccounts.find(admin => admin.username === username);
            if (existingAdmin && (!window.editingPelatihAdminId || existingAdmin.id !== window.editingPelatihAdminId)) {
                alert('Username admin sudah digunakan!');
                return;
            }
            
            if (window.editingPelatihAdminId) {
                // Edit existing admin
                const admin = adminAccounts.find(a => a.id === window.editingPelatihAdminId);
                admin.username = username;
                admin.password = password;
                
                alert('Akun admin berhasil diperbarui!');
                window.editingPelatihAdminId = null;
                
                // Reset button
                const submitBtn = document.querySelector('#pelatihAddAdminForm button[type="submit"]');
                submitBtn.innerHTML = '<i class="fas fa-plus mr-2"></i>Tambah Admin';
                submitBtn.classList.remove('bg-blue-600', 'hover:bg-blue-700');
                submitBtn.classList.add('bg-green-600', 'hover:bg-green-700');
            } else {
                // Add new admin
                const newAdmin = {
                    id: adminAccounts.length + 1,
                    username: username,
                    password: password,
                    createdAt: new Date().toISOString().split('T')[0]
                };
                
                adminAccounts.push(newAdmin);
                alert('Akun admin baru berhasil ditambahkan!');
            }
            
            populatePelatihAdminAccountsList();
            populateAdminAccountsList();
            this.reset();
        });

        // Password visibility toggle function
        function togglePasswordVisibility(inputId) {
            const input = document.getElementById(inputId);
            const icon = document.getElementById(inputId + '-icon');
            
            if (input && icon) {
                if (input.type === 'password') {
                    input.type = 'text';
                    icon.classList.remove('fa-eye');
                    icon.classList.add('fa-eye-slash');
                } else {
                    input.type = 'password';
                    icon.classList.remove('fa-eye-slash');
                    icon.classList.add('fa-eye');
                }
            }
        }

        // Camera functions
        function startCamera() {
            // Simulate camera start
            document.getElementById('cameraPreview').innerHTML = `
                <div class="w-full h-full bg-blue-100 rounded-lg flex items-center justify-center">
                    <div class="text-center">
                        <i class="fas fa-video text-4xl text-blue-600 mb-2"></i>
                        <p class="text-sm text-blue-600">Kamera Aktif</p>
                    </div>
                </div>
            `;
        }

        function capturePhoto() {
            if (selectedStudentId) {
                // Simulate photo capture
                document.getElementById('cameraPreview').innerHTML = `
                    <div class="w-full h-full bg-green-100 rounded-lg flex items-center justify-center">
                        <div class="text-center">
                            <i class="fas fa-check-circle text-4xl text-green-600 mb-2"></i>
                            <p class="text-sm text-green-600">Foto Tersimpan</p>
                        </div>
                    </div>
                `;
                
                // Mark attendance as present
                markAttendanceStatus(selectedStudentId, 'hadir');
                
                setTimeout(() => {
                    hideModal('cameraModal');
                    selectedStudentId = null;
                }, 1500);
            }
        }
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9632a3f93371ea7f',t:'MTc1MzE4NDE4OC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
